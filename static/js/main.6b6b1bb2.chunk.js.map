{"version":3,"sources":["utils/index.ts","serviceWorkerRegistration.ts","components/layout/container.tsx","components/app/appHeader.tsx","components/app/maintenance.tsx","components/app/navbar.tsx","components/misc/canonicalLink.tsx","components/gameRecords/index.tsx","components/app/index.tsx","index.tsx","data/source/api.ts","i18n.ts","components/misc/loading.tsx","components/gameRecords/table.tsx","data/types/gameMode.ts","components/gameRecords/model.tsx","components/misc/customizedLoadable.ts","data/types/constants.ts","components/gameRecords/routeSync.tsx","components/gameRecords/filterPanel.tsx","components/gameRecords/playerSearch.tsx","components/gameRecords/routes.tsx","components/form/checkboxGroup.tsx","components/form/datePicker.tsx","components/misc/tracker.tsx","data/types/index.ts","data/types/level.ts","utils/notify.ts","components/gameRecords/dataAdapterProvider.tsx","components/misc/alert.tsx","data/types/utils.ts","components/misc/scroller.tsx","data/source/records/loader.ts","data/source/records/provider.ts","components/gameRecords/modeSelector.tsx","data/source/misc.ts","data/types/metadata.ts","data/types/ranking.ts","utils/conf.ts","components/form/formRow.tsx","data/types/record.ts","data/types/zone.ts","components/gameRecords/player.tsx"],"names":["triggerRelayout","requestAnimationFrame","window","dispatchEvent","UIEvent","setTimeout","scrollToTop","scrollTo","formatPercent","x","toFixed","formatFixed3","formatIdentity","toString","useEventCallback","fn","dependencies","ref","useRef","Error","useEffect","current","useCallback","args","NOT_FINISHED","notFinished","__useAsyncCache","useAsync","maybePromise","cacheKey","useState","Promise","fulfilledValue","setFulfilledValue","cancelled","then","result","useAsyncFactory","factory","deps","useMemo","join","undefined","sum","numbers","reduce","a","b","isMobile","matchMedia","matches","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","onUpdate","onSuccess","catch","error","Container","title","children","fluid","className","AlertDefault","href","Conf","mirrorUrl","AlertEn","AlertJa","canonicalDomain","AppHeader","i18n","useTranslation","container","stateName","language","indexOf","MaintenanceHandler","msg","setMsg","setMaintenanceHandler","closable","NAV_ITEMS","filter","path","features","map","label","SITE_LINKS","CONFIGURATIONS","DEFAULT","ikeda","domain","active","LANGUAGES","code","isActive","some","pathname","startsWith","Navbar","t","mobileVisible","setMobileVisible","onToggleButtonClick","e","preventDefault","stopPropagation","handler","target","classList","contains","document","addEventListener","removeEventListener","to","siteTitle","type","data-toggle","data-target","aria-controls","aria-expanded","aria-label","onClick","id","activeClassName","clsx","changeLanguage","CanonicalLink","loc","useLocation","Helmet","rel","Routes","Loadable","loader","loading","GameRecords","Ranking","Statistics","RecentHighlight","ContestTools","App","defaultTitle","titleTemplate","showTopNotice","category","contestTools","Sentry","dsn","release","Object","values","rootElement","getElementById","render","URL","process","origin","fetch","headers","response","contentType","get","status","ready","unregister","reload","checkValidServiceWorker","waitingServiceWorker","waiting","event","postMessage","statusPageScript","createElement","async","src","body","appendChild","DATA_MIRRORS","PROBE_TIMEOUT","selectedMirror","localStorage","getItem","onMaintenance","fetchWithTimeout","url","opts","timeout","abortController","AbortController","signal","abort","timeoutToken","ret","clearTimeout","mirrorProbePromise","fetchData","warn","completedResponse","race","mirror","resp","setItem","resolve","reject","apiCache","apiGet","apiSuffix","ok","assign","statusText","json","bind","data","maintenance","keys","length","DEBUG","use","LanguageDetector","initReactI18next","init","resources","lowerCaseLng","fallbackLng","defaultNS","debug","whitelist","detection","order","caches","checkWhitelist","returnEmptyString","returnNull","saveMissing","missingKeyHandler","nsSeparator","keySeparator","interpolation","escapeValue","on","Loading","size","role","Players","React","memo","game","activePlayerId","players","player","accountId","cellFormatTime","cellData","dayjs","unix","format","cellFormatFullTime","rowData","GameRecord","formatStartDate","formatFullStartTime","cellFormatRank","columnData","style","color","getPlayerRankColor","getPlayerRankLabel","slice","cellFormatGameMode","modeLabel","parseInt","makeColumn","builder","key","Math","random","outer","cloneElement","COLUMN_GAMEMODE","table","showGameMode","dataKey","cellRenderer","width","COLUMN_RANK","COLUMN_PLAYERS","flexGrow","COLUMN_STARTTIME","headerClassName","COLUMN_ENDTIME","COLUMN_FULLTIME","GameRecordTable","columns","withActivePlayer","alwaysShowDetailLink","useDataAdapter","scrollerProps","useScrollerProps","isScrolling","onChildScroll","scrollTop","height","registerChild","rowGetter","index","getRowClassName","isItemLoaded","even","noRowsRenderer","hasCount","shouldTriggerLayout","getUnfilteredCount","memoColumns","getCount","disableHeight","autoHeight","rowCount","rowHeight","headerHeight","onScroll","rowClassName","GameMode","getFixedT","modeLabelNonTranslated","mode","replace","parseCombinedMode","modeString","split","trim","DEFAULT_MODEL","freeze","removeExtraParams","model","playerId","selectedModes","startDate","endDate","searchText","rank","selectedMode","date","ModelContext","createContext","useModel","useContext","isSameModel","generatePath","OnRouteModelUpdatedContext","useOnRouteModelUpdated","ModelProvider","history","useHistory","useReducer","oldModel","newModel","setModel","dispatchModelUpdate","newProps","valueOf","normalizeUpdate","value","Provider","CustomizedLoadable","options","delay","PLAYER_RANKS","RANK_LABELS","parseOptionalDate","s","defaultValue","ModelBuilders","params","rankColors","search","listing","isValid","startOf","RouteSync","view","onRouteModelUpdated","useParams","query","URLSearchParams","modelResult","DEFAULT_DATE","FilterPanel","updateModel","setMode","setDate","min","dateMin","onChange","availableModes","playerSearchCache","normalizeName","toLowerCase","PlayerSearchResult","version","setVersion","cachedResult","prefix","normalizedPrefix","isExactMatch","findRawResultFromCache","mayHaveMore","filteredPlayers","forEach","nickname","push","isLoading","debounceToken","searchPlayer","Date","getTime","generatePlayerPathById","getLevelTag","level","PlayerSearch","PlayerDetails","PLAYER_PATH","PATH","dateToStringSafe","dateObj","year","genPath","dateString","GameRecordTablePlayerView","setSearchText","exact","currentTarget","CheckboxGroup","props","items","groupKey","selectedItems","i18nNamespace","activeKey","setActiveKey","selectedItemKeys","Set","item","add","setSelected","isSelected","has","newSet","delete","selectSingle","find","name","checked","htmlFor","onMouseEnter","onMouseLeave","DatePicker","max","handleChange","currentCategory","PageCategory","useLayoutEffect","oldCategory","TrackerImpl","peek","ga","hitType","page","contentGroup1","Tracker","host","__loadGa","LEVEL_MAX_POINTS","LEVEL_PENALTY","LEVEL_PENALTY_3","LEVEL_PENALTY_E","LEVEL_PENALTY_E_3","LEVEL_ALLOWED_MODES","101","102","103","金","金东","104","玉","玉东","105","王座","王座东","106","201","202","203","三金","三金东","204","三玉","三玉东","205","三王座","三王座东","206","MODE_PENALTY","getTranslatedLevelTags","rawTags","charCodeAt","Array","fill","_","Level","levelId","_majorRank","_minorRank","_numPlayerId","realId","this","floor","other","includes","getMaxPoint","majorRank","minorRank","score","maxPoints","getNextLevel","getStartingPoint","getPreviousLevel","getAdjustedLevel","getTag","formatAdjustedScore","LevelWithDelta","obj","formatAdjustedScoreWithTag","delta","implPromise","message","loadingPlaceholder","DUMMY_DATA_ADAPTER","noop","DataAdapter","provider","onDataUpdate","_provider","_onDataUpdate","_triggeredRequest","promise","_callHook","reason","maybeCount","getCountMaybeSync","_installHook","getUnfilteredCountSync","getMetadataSync","hook","DataAdapterContext","Consumer","useDataAdapterCommon","dataProvider","onError","dataAdapter","setDataAdapter","refreshDataAdapter","adapter","cancelUpdateHook","setUpdateHook","DataAdapterProvider","dataProviders","searchPredicate","memoFunc","memoDeps","needPredicate","getRankIndexByPlayer","usePredicate","getProviderKey","DataProvider","createListing","createPlayer","createProvider","setFilterPredicate","notify","DataAdapterProviderCustom","Alert","Fragment","stateKey","closed","setClosed","Cont","data-dismiss","aria-hidden","getRankLabelByIndex","ScrollerContext","Scroller","CHUNK_SIZE","RecentHighlightDataLoader","numItems","_data","_index","every","uuid","_id","records","recordMap","sort","startTime","count","ListingDataLoader","_date","_cursor","_modeString","cursor","clone","shouldReturnEmptyResult","Infinity","isBefore","isSame","chunk","PlayerDataLoader","_playerId","_startDate","_endDate","_mode","_initialParams","_tag","endOf","_getParams","_getDatePath","stats","extended_stats","extendedStats","crossStats","cross_stats","max_level","played_modes","DataProviderImpl","_loader","_metadata","_metadataError","_countPromise","_loadingPromise","_filterPredicate","_filteredIndices","_filterResultCache","predicate","updateFilteredIndices","getEstimatedCountSync","indices","i","metadata","getMetadata","mappedIndex","_mapItemIndex","skipPreload","newMappedIndex","curLength","_loadNextChunk","preload","getEstimatedChunkSize","requestedIndex","getNextChunk","nextChunk","splice","createHightlight","ModeSelector","String","newItems","limit","encodeURIComponent","getDeltaRanking","timespan","getCareerRanking","modeId","getGlobalStatistics","modes","getFanStats","getRankRateBySeat","rawResp","counts","maxRank","modeIdStr","seatId","numGames","RANK_DELTA_4","RANK_DELTA_3","RANK_DELTA","MODE_DELTA","MODE_BASE_POINT","RankRates","getAvg","rates","normalize","total","FanStatEntry2","formatFan","entry","役满","FanStatEntryList","formatFanSummary","list","calculateDeltaPoint","includePenalty","trimNumber","ceil","getPenaltyPoint","PlayerMetadata","calculateRankDeltaPoints","rank_avg_score","calculateExpectedGamePoint","point","rank_rates","estimateStableLevel","calcPoint","lastPositiveLevel","expectedGamePoint","abs","isAllowedMode","prevLevel","formatStableLevel2","formatNumber","translatedLevelTags","getStableLevelComponents","estimateStableLevel2","RankingTimeSpan","CareerRankingType","sessionStorage","ranking","rankingGroups","statistics","estimatedStableLevel","statisticsSubPages","rankBySeat","dataByRank","fanStats","modePreference","rootClassName","contest","ConfBase","test","m","exec","mergeDeep","isObject","constructor","objects","prev","pVal","oVal","isArray","documentElement","FormRow","inline","ns","rec","sortedPlayers","encodeAccountId","getStartTime","getRecordLink","trailer","AccountZone","getAccountZoneTag","Unknown","China","Japan","International","getAccountZone","Player","isTop"],"mappings":"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","file":"static/js/main.6b6b1bb2.chunk.js","sourcesContent":["import React, { useState, useEffect, useMemo, useRef, useCallback } from \"react\";\n\nexport function triggerRelayout() {\n  requestAnimationFrame(() => window.dispatchEvent(new UIEvent(\"resize\")));\n  setTimeout(function () {\n    window.dispatchEvent(new UIEvent(\"resize\"));\n  }, 200);\n}\nexport function scrollToTop() {\n  window.scrollTo(0, 0);\n  requestAnimationFrame(() => window.scrollTo(0, 0));\n}\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const formatPercent = (x: any) => {\n  if (!x) {\n    return \"0%\";\n  }\n  if (x < 0.0001) {\n    return \"<0.01%\";\n  }\n  return `${(x * 100).toFixed(2)}%`;\n};\n\nexport const formatFixed3 = (x: number) => x.toFixed(3);\nexport const formatIdentity = (x: number) => x.toString();\n\nexport function useEventCallback<T extends unknown[]>(fn: (...args: T) => void, dependencies: React.DependencyList) {\n  const ref = useRef<(...args: T) => void>(() => {\n    throw new Error(\"Cannot call an event handler while rendering.\");\n  });\n\n  useEffect(() => {\n    ref.current = fn;\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [fn, ...dependencies]);\n\n  return useCallback(\n    (...args) => {\n      const fn = ref.current;\n      return fn(...(args as T));\n    },\n    [ref]\n  );\n}\n\ntype NotFinished = { notFinished: string };\nconst NOT_FINISHED = { notFinished: \"yes\" };\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst __useAsyncCache = {} as { [key: string]: any };\n\nexport function useAsync<T>(maybePromise: T | Promise<T>, cacheKey?: string): T | undefined {\n  if (cacheKey && __useAsyncCache[cacheKey]) {\n    maybePromise = __useAsyncCache[cacheKey];\n  }\n  const [fulfilledValue, setFulfilledValue] = useState<T | NotFinished>(\n    maybePromise instanceof Promise ? NOT_FINISHED : maybePromise\n  );\n  useEffect(() => {\n    let cancelled = false;\n    if (maybePromise instanceof Promise) {\n      setFulfilledValue(NOT_FINISHED);\n      maybePromise.then((result) => {\n        if (cancelled) {\n          return;\n        }\n        if (cacheKey) {\n          __useAsyncCache[cacheKey] = result;\n        }\n        setFulfilledValue(result);\n      });\n    } else {\n      setFulfilledValue(maybePromise);\n    }\n    return () => {\n      cancelled = true;\n    };\n  }, [maybePromise, cacheKey]);\n  if (fulfilledValue !== NOT_FINISHED) {\n    return fulfilledValue as T;\n  }\n  return undefined;\n}\nexport function useAsyncFactory<T>(\n  factory: () => Promise<T>,\n  deps: React.DependencyList,\n  cacheKey?: string\n): T | undefined {\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const promise = useMemo(factory, deps);\n  return useAsync(promise, cacheKey ? `${cacheKey}-${deps.join(\",\")}` : undefined);\n}\n\nexport function sum(numbers: number[]): number {\n  return numbers.reduce((a, b) => a + b, 0);\n}\n\nexport function isMobile() {\n  return !!window.matchMedia(\"(max-width: 575.75px)\").matches;\n}\n","/* eslint-disable no-eq-null */\n/* eslint-disable @typescript-eslint/no-use-before-define */\n// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://cra.link/PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See https://cra.link/PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { \"Service-Worker\": \"script\" },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (response.status === 404 || (contentType != null && contentType.indexOf(\"javascript\") === -1)) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\"No internet connection found. App is running in offline mode.\");\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React, { ReactNode } from \"react\";\r\n\r\nexport const Container = ({ title = undefined, children = undefined as ReactNode, fluid = false }) => (\r\n  <div className={`my-5 container${fluid ? \"-fluid\" : \"\"}`}>\r\n    <div className=\"row\">\r\n      <div className=\"col-sm-12\">\r\n        {title && <h2 className=\"mb-4\">{title}</h2>}\r\n        {children}\r\n      </div>\r\n    </div>\r\n  </div>\r\n);\r\n","import React from \"react\";\r\n\r\nimport { Container } from \"../layout\";\r\nimport { Alert } from \"../misc/alert\";\r\nimport Conf from \"../../utils/conf\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nfunction AlertDefault() {\r\n  return (\r\n    <>\r\n      <h4>说明</h4>\r\n      <ul>\r\n        <li>本页面数据由第三方维护，不能绝对保证完整和正确，信息仅供参考，请勿用于不良用途。</li>\r\n        <li>记录包含雀魂段位战金之间、玉之间及王座之间的牌谱。</li>\r\n        <li>页面不是实时更新，对局一般会在结束后数分钟至数小时内出现。</li>\r\n        <li>对局数据收集从 2019 年 11 月 29 日开始（玉南及王座南为 2019 年 8 月 23 日），之前的对局已无法获取。</li>\r\n        <li>\r\n          网站主线路会收集少量匿名浏览数据作后续改进及优化之用，如不希望被收集数据，请使用\r\n          <a href={Conf.mirrorUrl}>镜像线路</a>。\r\n        </li>\r\n        <li>\r\n          如有问题或建议，请戳 <a href=\"mailto:i@sapika.ch\">SAPikachu (i@sapika.ch)</a> 或{\" \"}\r\n          <a href=\"https://github.com/SAPikachu/amae-koromo/\">提交 Issue</a>。\r\n        </li>\r\n        <li>\r\n          感谢 <a href=\"https://github.com/kamicloud/\">Kamicloud</a> 提供部分数据。\r\n        </li>\r\n      </ul>\r\n    </>\r\n  );\r\n}\r\n\r\nfunction AlertEn() {\r\n  return (\r\n    <>\r\n      <h4>Notes</h4>\r\n      <ul>\r\n        <li>\r\n          This is a fan site, data accuracy can&apos;t be fully guaranteed, please use the data for reference only and\r\n          don&apos;t use it for malicious purpose.\r\n        </li>\r\n        <li>\r\n          Data is not updated in real-time, finished matches will show up on the site in a few minutes to a few hours.\r\n        </li>\r\n        <li>\r\n          Data collection was started from 2019-11-29 (2019-08-23 for Jade South and Throne South matches), matches\r\n          finished before then could no longer be retrived.\r\n        </li>\r\n        <li>\r\n          Main mirror of the site collects small amount of anonymous usage data for improving the site. If you wish to\r\n          opt-out from this, please use <a href={Conf.mirrorUrl}>the alternative mirror</a>.\r\n        </li>\r\n        <li>\r\n          If you have any question or suggestion, feel free to email{\" \"}\r\n          <a href=\"mailto:i@sapika.ch\">SAPikachu (i@sapika.ch)</a> or{\" \"}\r\n          <a href=\"https://github.com/SAPikachu/amae-koromo/\">submit an issue</a>.\r\n        </li>\r\n        <li>\r\n          English translation of the site is contributed by <a href=\"https://github.com/Mjonir\">Mjonir</a> and{\" \"}\r\n          <a href=\"https://github.com/kator-278\">kator-278</a>. Thank you!\r\n        </li>\r\n        <li>\r\n          感谢 <a href=\"https://github.com/kamicloud/\">Kamicloud</a> 提供部分数据。\r\n        </li>\r\n      </ul>\r\n    </>\r\n  );\r\n}\r\n\r\nfunction AlertJa() {\r\n  return (\r\n    <>\r\n      <h4>説明</h4>\r\n      <ul>\r\n        <li>\r\n          当サイトは非公式サイトで、データの完全性と正確性が保証できません、予めご了承ください。サイトの内容を悪用しないでください。\r\n        </li>\r\n        <li>データの更新はリアルタイムではありません。対局がサイトに載るまで数分から数時間がかかります。</li>\r\n        <li>\r\n          データの収集は 2019 年 11 月 29 日から（玉南と王座南は 2019 年 8 月 23\r\n          日）です。収集開始以前の対局は検索できません。\r\n        </li>\r\n        <li>\r\n          <a href={\"https://\" + Conf.canonicalDomain}>メインサイト</a>\r\n          はサービス向上のため、少しの匿名化された利用情報を収集しています。希望しない方は、\r\n          <a href={Conf.mirrorUrl}>ミラーサイト</a>をご利用ください。\r\n        </li>\r\n        <li>\r\n          内容の誤り・誤植等はご報告いただけますと幸いです。 <a href=\"mailto:i@sapika.ch\">SAPikachu (i@sapika.ch)</a>{\" \"}\r\n          または <a href=\"https://github.com/SAPikachu/amae-koromo/\">GitHub</a> でご連絡ください。\r\n        </li>\r\n        <li>\r\n          感谢 <a href=\"https://github.com/kamicloud/\">Kamicloud</a> 提供部分数据。\r\n        </li>\r\n      </ul>\r\n    </>\r\n  );\r\n}\r\n\r\nexport function AppHeader() {\r\n  const { i18n } = useTranslation();\r\n  return (\r\n    <Alert container={Container} stateName=\"topNote20201220\">\r\n      {i18n.language.indexOf(\"ja\") === 0 ? (\r\n        <AlertJa />\r\n      ) : i18n.language.indexOf(\"en\") === 0 ? (\r\n        <AlertEn />\r\n      ) : (\r\n        <AlertDefault />\r\n      )}\r\n    </Alert>\r\n  );\r\n}\r\n","import * as React from \"react\";\nimport { useState } from \"react\";\n\nimport { Alert } from \"../misc/alert\";\nimport { Container } from \"../layout/container\";\nimport { setMaintenanceHandler } from \"../../data/source/api\";\n\nexport function MaintenanceHandler({ children }: { children: React.ReactElement }): React.ReactElement {\n  const [msg, setMsg] = useState(\"\");\n  setMaintenanceHandler(setMsg);\n  if (!msg) {\n    return children;\n  }\n  return (\n    <Alert container={Container} closable={false}>\n      <h4>临时维护公告</h4>\n      <p>{msg}</p>\n    </Alert>\n  );\n}\n","import React from \"react\";\nimport { Location } from \"history\";\nimport { Link, NavLink } from \"react-router-dom\";\nimport { useState, useEffect, useCallback } from \"react\";\nimport Conf, { CONFIGURATIONS } from \"../../utils/conf\";\nimport { useTranslation } from \"react-i18next\";\nimport clsx from \"clsx\";\n\nconst NAV_ITEMS = [\n  [\"最近役满\", \"highlight\"],\n  [\"排行榜\", \"ranking\"],\n  [\"大数据\", \"statistics\"],\n]\n  .filter(([, path]) => !(path in Conf.features) || Conf.features[path as keyof typeof Conf.features])\n  .map(([label, path]) => ({ label, path }));\n\nconst SITE_LINKS = [\n  [\"四麻\", CONFIGURATIONS.DEFAULT.canonicalDomain],\n  [\"三麻\", CONFIGURATIONS.ikeda.canonicalDomain],\n].map(([label, domain]) => ({ label, domain, active: Conf.canonicalDomain === domain }));\n\nconst LANGUAGES = [\n  [\"中文\", \"zh-hans\"],\n  [\"日本語\", \"ja\"],\n  [\"English\", \"en\"],\n].map(([label, code]) => ({ label, code }));\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction isActive(match: any, location: Location): boolean {\n  if (!match) {\n    return false;\n  }\n  return !NAV_ITEMS.some(({ path }) => location.pathname.startsWith(\"/\" + path));\n}\n\nexport default function Navbar() {\n  const { t, i18n } = useTranslation();\n  const [mobileVisible, setMobileVisible] = useState(false);\n  const onToggleButtonClick = useCallback(\n    (e: React.MouseEvent<HTMLButtonElement>) => {\n      e.preventDefault();\n      e.stopPropagation();\n      setMobileVisible(!mobileVisible);\n    },\n    [mobileVisible, setMobileVisible]\n  );\n  useEffect(() => {\n    if (!mobileVisible) {\n      return;\n    }\n    const handler = (e: MouseEvent) => {\n      if ((e.target as HTMLElement).classList.contains(\"navbar-toggler\")) {\n        return;\n      }\n      setMobileVisible(false);\n    };\n    document.addEventListener(\"click\", handler);\n    return () => document.removeEventListener(\"click\", handler);\n  }, [mobileVisible, setMobileVisible]);\n  return (\n    <nav className=\"navbar navbar-expand-lg navbar-light fixed-top\">\n      <div className=\"container\">\n        <Link className=\"navbar-brand\" to=\"/\">\n          {t(Conf.siteTitle)}\n        </Link>\n        <button\n          className=\"navbar-toggler\"\n          type=\"button\"\n          data-toggle=\"collapse\"\n          data-target=\"#navbarNavAltMarkup\"\n          aria-controls=\"navbarNavAltMarkup\"\n          aria-expanded=\"false\"\n          aria-label=\"Toggle navigation\"\n          onClick={onToggleButtonClick}\n        >\n          <span className=\"navbar-toggler-icon\"></span>\n        </button>\n        <div\n          className={`collapse navbar-collapse justify-content-end ${mobileVisible ? \"\" : \"d-none\"} d-lg-block`}\n          id=\"navbarNavAltMarkup\"\n        >\n          <div className=\"navbar-nav\">\n            <NavLink className=\"nav-item nav-link\" activeClassName=\"active\" to=\"/\" isActive={isActive}>\n              {t(\"主页\")}\n            </NavLink>\n            {NAV_ITEMS.map(({ label, path }) => (\n              <NavLink key={path} className=\"nav-item nav-link\" activeClassName=\"active\" to={`/${path}`}>\n                {t(label)}\n              </NavLink>\n            ))}\n            <span className=\"sep\"></span>\n            {SITE_LINKS.map(({ label, domain, active }) => (\n              <a key={domain} className={clsx(\"nav-item nav-link\", active && \"active\")} href={`https://${domain}/`}>\n                {t(label)}\n              </a>\n            ))}\n            <span className=\"sep\"></span>\n            <a className=\"nav-item nav-link\" href=\"https://twitter.com/AmaeKoromo_MajS\">\n              {t(\"Twitter\")}\n            </a>\n            <span className=\"sep\"></span>\n            {LANGUAGES.map(({ label, code }) => (\n              <button\n                key={code}\n                className={clsx(\"nav-item nav-link\", i18n.language === code && \"active\")}\n                onClick={(e) => {\n                  e.preventDefault();\n                  i18n.changeLanguage(code);\n                }}\n              >\n                {label}\n              </button>\n            ))}\n          </div>\n        </div>\n      </div>\n    </nav>\n  );\n}\n","import React from \"react\";\nimport { Helmet } from \"react-helmet\";\nimport { useLocation } from \"react-router\";\nimport Conf from \"../../utils/conf\";\n\nexport default function CanonicalLink() {\n  const loc = useLocation();\n  return (\n    <Helmet>\n      <link rel=\"canonical\" href={`https://${Conf.canonicalDomain}${loc.pathname}`} />\n    </Helmet>\n  );\n}\n","import React from \"react\";\r\n\r\nimport { ModelProvider } from \"./model\";\r\nimport { DataAdapterProvider } from \"./dataAdapterProvider\";\r\nimport Loadable from \"../misc/customizedLoadable\";\r\nimport Loading from \"../misc/loading\";\r\n\r\nconst Routes = Loadable({\r\n  loader: () => import(\"./routes\"),\r\n  loading: () => <Loading />\r\n});\r\n\r\nexport default function GameRecords() {\r\n  // This makes data load in parallel with subcomponents\r\n  return (\r\n    <ModelProvider>\r\n      <DataAdapterProvider>\r\n        <Routes />\r\n      </DataAdapterProvider>\r\n    </ModelProvider>\r\n  );\r\n}\r\n","import React from \"react\";\n\nimport { BrowserRouter as Router, Route, Switch } from \"react-router-dom\";\nimport Loadable from \"../misc/customizedLoadable\";\nimport Scroller from \"../misc/scroller\";\n\nimport { Container } from \"../layout\";\nimport { AppHeader } from \"./appHeader\";\nimport { MaintenanceHandler } from \"./maintenance\";\nimport Navbar from \"./navbar\";\nimport CanonicalLink from \"../misc/canonicalLink\";\nimport Loading from \"../misc/loading\";\nimport GameRecords from \"../gameRecords\";\nimport Tracker, { PageCategory } from \"../misc/tracker\";\nimport Conf from \"../../utils/conf\";\nimport { useTranslation } from \"react-i18next\";\n\nconst Helmet = Loadable({\n  loader: () => import(\"react-helmet\"),\n  loading: () => <></>,\n});\nconst Ranking = Loadable({\n  loader: () => import(\"../ranking\"),\n  loading: () => <Loading />,\n});\nconst Statistics = Loadable({\n  loader: () => import(\"../statistics\"),\n  loading: () => <Loading />,\n});\nconst RecentHighlight = Loadable({\n  loader: () => import(\"../recentHighlight\"),\n  loading: () => <Loading />,\n});\nconst ContestTools = Loadable({\n  loader: () => import(\"../contestTools\"),\n  loading: () => <Loading />,\n});\n\nfunction App() {\n  const { t, i18n } = useTranslation();\n  return (\n    <div className={\"lang-\" + i18n.language}>\n      <Router>\n        <Helmet defaultTitle={t(Conf.siteTitle)} titleTemplate={`%s | ${t(Conf.siteTitle)}`} />\n        <CanonicalLink />\n        <Tracker />\n        <Navbar />\n        <MaintenanceHandler>\n          <Scroller>\n            {Conf.showTopNotice ? <AppHeader /> : <></>}\n            <Container>\n              <Switch>\n                <Route path=\"/ranking\">\n                  <PageCategory category=\"Ranking\" />\n                  <Ranking />\n                </Route>\n                <Route path=\"/statistics\">\n                  <PageCategory category=\"Statistics\" />\n                  <Statistics />\n                </Route>\n                <Route path=\"/highlight\">\n                  <PageCategory category=\"RecentHighlight\" />\n                  <RecentHighlight />\n                </Route>\n                {Conf.features.contestTools ? <Route path=\"/contest-tools\"><ContestTools/></Route> : null}\n                <Route path=\"/\">\n                  <GameRecords />\n                </Route>\n              </Switch>\n            </Container>\n          </Scroller>\n        </MaintenanceHandler>\n      </Router>\n    </div>\n  );\n}\nexport default App;\n","import * as React from \"react\";\nimport { render } from \"react-dom\";\nimport * as Sentry from \"@sentry/react\";\n\nimport * as serviceWorker from \"./serviceWorkerRegistration\";\nimport \"./i18n\";\n\nimport \"./styles/bootstrap-custom.scss\";\nimport \"./styles/styles.scss\";\n\nimport App from \"./components/app\";\n\nif (process.env.NODE_ENV === \"production\") {\n  Sentry.init({\n    dsn: \"https://876acfa224b8425c92f9553b9c6676be@sentry.sapikachu.net/31\",\n    release: process.env.REACT_APP_VERSION || \"unknown\",\n  });\n}\n\nif (!Object.values) {\n  import(\"./utils/polyfill\");\n}\n\nconst rootElement = document.getElementById(\"root\");\nrender(\n  <Sentry.ErrorBoundary>\n    <App />\n  </Sentry.ErrorBoundary>,\n  rootElement\n);\n\nserviceWorker.register({\n  onUpdate(registration) {\n    const waitingServiceWorker = registration.waiting || navigator.serviceWorker.controller;\n\n    if (waitingServiceWorker) {\n      if (waitingServiceWorker.state === \"activated\") {\n        window.location.reload();\n        return;\n      }\n      waitingServiceWorker.addEventListener(\"statechange\", (event) => {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        if (event.target && (event.target as any).state === \"activated\") {\n          window.location.reload();\n        }\n      });\n      waitingServiceWorker.postMessage({ type: \"SKIP_WAITING\" });\n    }\n  },\n});\n\nconst statusPageScript = document.createElement(\"script\");\nstatusPageScript.async = true;\nstatusPageScript.src = \"https://qltr0c2md09b.statuspage.io/embed/script.js\";\ndocument.body.appendChild(statusPageScript);","/* eslint-disable @typescript-eslint/no-empty-function */\nimport Conf from \"../../utils/conf\";\n\nconst DATA_MIRRORS = [\n  \"https://ak-data-2.sapk.ch/\",\n  \"https://ak-data-1.sapk.ch/\",\n  \"https://ak-data-3.sapk.ch/\",\n  \"https://ak-data-5.sapk.ch/\",\n];\nconst PROBE_TIMEOUT = 15000;\n\nlet selectedMirror = localStorage.getItem(\"selectedMirror\") || DATA_MIRRORS[0];\n\nlet onMaintenance: (msg: string) => void = () => {};\n\nexport function setMaintenanceHandler(handler: (msg: string) => void) {\n  onMaintenance = handler;\n}\n\nasync function fetchWithTimeout(\n  url: string,\n  opts: Parameters<typeof fetch>[1] = {},\n  timeout = 5000\n): Promise<Response> {\n  const abortController = window.AbortController ? new AbortController() : { signal: undefined, abort: () => {} };\n  const timeoutToken = setTimeout(function () {\n    abortController.abort();\n  }, timeout);\n  const ret = fetch(url, { ...opts, signal: abortController.signal }) as Promise<Response>;\n  ret.then(() => clearTimeout(timeoutToken)).catch(() => clearTimeout(timeoutToken));\n  return ret;\n}\n\nlet mirrorProbePromise = null as null | Promise<Response>;\n\nasync function fetchData(path: string): Promise<Response> {\n  try {\n    return await fetchWithTimeout(selectedMirror + path);\n  } catch (e) {\n    console.warn(e);\n    if (mirrorProbePromise) {\n      console.warn(`Failed to fetch data from mirror ${selectedMirror}, waiting for probe in progress...`);\n      await mirrorProbePromise.then(() => {});\n      return fetchData(path);\n    }\n    console.warn(`Failed to fetch data from mirror ${selectedMirror}, trying other mirror...`);\n  }\n\n  mirrorProbePromise = (async function () {\n    let completedResponse = null as null | Response;\n    return Promise.race(\n      DATA_MIRRORS.map((mirror) =>\n        fetchWithTimeout(mirror + path, {}, PROBE_TIMEOUT)\n          .then(function (resp) {\n            if (completedResponse) {\n              return resp;\n            }\n            completedResponse = resp;\n            selectedMirror = mirror;\n            localStorage.setItem(\"selectedMirror\", selectedMirror);\n            console.log(`Set ${mirror} as preferred`);\n            return resp;\n          })\n          .catch(\n            (e) =>\n              new Promise((resolve) =>\n                setTimeout(() => {\n                  if (completedResponse) {\n                    return resolve(completedResponse);\n                  }\n                  resolve(e); // Do not reject here, may cause unhandled promise rejection\n                }, PROBE_TIMEOUT)\n              )\n          )\n      )\n    ).then((result) => {\n      if (\"ok\" in (result as Response | Error)) {\n        return result;\n      }\n      return Promise.reject(result);\n    }) as Promise<Response>;\n  })();\n  mirrorProbePromise.then(() => (mirrorProbePromise = null)).catch(() => (mirrorProbePromise = null));\n  return mirrorProbePromise;\n}\n\nlet apiCache = {} as { [path: string]: unknown };\n\nexport type ApiError = Error & {\n  status: number;\n  statusText: string;\n  url: string;\n};\n\nexport async function apiGet<T>(path: string): Promise<T> {\n  if (path in apiCache) {\n    return apiCache[path] as T;\n  }\n  const resp = await fetchData(Conf.apiSuffix + path);\n  if (!resp.ok) {\n    const error = new Error(\"Failed API call\");\n    Object.assign(error, {\n      response: resp,\n      status: resp.status,\n      statusText: resp.statusText,\n      headers: resp.headers,\n      url: resp.url,\n      json: resp.json.bind(resp),\n    });\n    throw error;\n  }\n  const data = await resp.json();\n  if (data.maintenance) {\n    onMaintenance(data.maintenance);\n    return new Promise(() => {}) as Promise<T>; // Freeze all other components\n  }\n  if (Object.keys(apiCache).length > 500) {\n    apiCache = {};\n  }\n  apiCache[path] = data;\n  return data as T;\n}\n","import i18n from \"i18next\";\nimport { initReactI18next } from \"react-i18next\";\nimport LanguageDetector from \"i18next-browser-languagedetector\";\n\nimport resources from \"./translations.json\";\nimport { triggerRelayout } from \"./utils\";\n\nconst DEBUG = process.env.NODE_ENV === \"development\" && sessionStorage.i18nDebug;\n\nif (DEBUG) {\n  sessionStorage.removeItem(\"__i18nMissingKeys\");\n}\n\ni18n\n  .use(LanguageDetector)\n  .use(initReactI18next) // passes i18n down to react-i18next\n  .init({\n    resources,\n    lowerCaseLng: true,\n    fallbackLng: \"zh-hans\",\n    defaultNS: \"default\",\n    debug: DEBUG,\n    whitelist: [\"ja\", \"zh-hans\", \"en\"],\n    detection: {\n      order: [\"localStorage\", \"navigator\"],\n      caches: [\"localStorage\"],\n      checkWhitelist: true,\n    },\n\n    returnEmptyString: false,\n    returnNull: false,\n\n    saveMissing: DEBUG,\n    missingKeyHandler: DEBUG\n      ? function (lng, ns, key) {\n          const missingKeys = JSON.parse(sessionStorage.getItem(\"__i18nMissingKeys\") || \"{}\") || {};\n          const l = i18n.language;\n          if (l === \"zh-hans\") {\n            return;\n          }\n          missingKeys[l] = missingKeys[l] || {};\n          missingKeys[l][ns] = missingKeys[l][ns] || {};\n          missingKeys[l][ns][key] = \"\";\n          sessionStorage.setItem(\"__i18nMissingKeys\", JSON.stringify(missingKeys));\n        }\n      : false,\n\n    nsSeparator: false,\n    keySeparator: false,\n\n    interpolation: {\n      escapeValue: false,\n    },\n  });\n\ni18n.on(\"languageChanged\", function () {\n  triggerRelayout();\n});\n\nexport default i18n;\n","import React from \"react\";\n\nexport default function Loading({\n  size = \"normal\",\n  className = \"\",\n}: {\n  className?: string;\n  size?: \"normal\" | \"small\";\n}) {\n  return (\n    <div className={`spinner-container d-flex justify-content-center m-${size === \"normal\" ? 5 : 1} ${className}`}>\n      <div className={`spinner-border ${size === \"normal\" ? \"\" : \"spinner-border-sm\"}`} role=\"status\">\n        <span className=\"sr-only\">Loading...</span>\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { useCallback, useEffect, useMemo } from \"react\";\nimport { TableCellProps, Index } from \"react-virtualized\";\nimport { Table, Column } from \"react-virtualized/dist/es/Table\";\nimport { AutoSizer } from \"react-virtualized/dist/es/AutoSizer\";\nimport dayjs from \"dayjs\";\nimport clsx from \"clsx\";\n\nimport { GameRecord, modeLabel } from \"../../data/types\";\nimport { Player } from \"./player\";\nimport { useScrollerProps } from \"../misc/scroller\";\nimport { useDataAdapter } from \"./dataAdapterProvider\";\nimport { triggerRelayout, isMobile } from \"../../utils/index\";\nimport Loading from \"../misc/loading\";\nimport Conf from \"../../utils/conf\";\nimport { Trans, useTranslation } from \"react-i18next\";\nimport i18n from \"../../i18n\";\n\nexport { Column } from \"react-virtualized/dist/es/Table\";\n\nconst formatTime = (x: number) => (x ? dayjs.unix(x).format(\"HH:mm\") : null);\n\ntype ActivePlayerId = number | string | ((x: GameRecord) => number | string);\n\nconst Players = React.memo(\n  ({ game, activePlayerId }: { game: GameRecord; activePlayerId?: ActivePlayerId; language?: string }) => {\n    if (typeof activePlayerId === \"function\") {\n      activePlayerId = activePlayerId(game);\n    }\n    if (typeof activePlayerId !== \"string\") {\n      activePlayerId = activePlayerId?.toString() || \"\";\n    }\n    return (\n      <div className=\"row no-gutters\">\n        {game.players.map((x) => (\n          <div key={x.accountId} className=\"col-12 col-md-6 pr-1\">\n            <Player game={game} player={x} isActive={x.accountId.toString() === activePlayerId} />\n          </div>\n        ))}\n      </div>\n    );\n  }\n);\n\nconst cellFormatTime = ({ cellData }: TableCellProps) => formatTime(cellData);\nconst cellFormatFullTime = ({ rowData }: TableCellProps) =>\n  rowData.loading ? \"\" : isMobile() ? GameRecord.formatStartDate(rowData) : GameRecord.formatFullStartTime(rowData);\nconst cellFormatRank = ({ rowData, columnData }: TableCellProps) =>\n  !rowData || rowData.loading || !columnData.activePlayerId ? (\n    \"\"\n  ) : (\n    <span\n      className=\"font-weight-bold\"\n      style={{ color: GameRecord.getPlayerRankColor(rowData, columnData.activePlayerId) }}\n    >\n      {GameRecord.getPlayerRankLabel(rowData, columnData.activePlayerId).slice(0, 1)}\n    </span>\n  );\nconst cellFormatGameMode = ({ cellData }: TableCellProps) => (cellData ? modeLabel(parseInt(cellData)) : \"\");\n\nfunction getRowHeight() {\n  if (window.matchMedia(\"(min-width: 768px)\").matches) {\n    return 70;\n  }\n  if (!isMobile()) {\n    return 140;\n  }\n  return 100;\n}\n\ntype TableColumnDefKey = {\n  key?: string;\n};\nexport type TableColumn = React.FunctionComponentElement<Column> | false | undefined | null;\nexport type TableColumnDef = TableColumnDefKey & (() => TableColumn);\n\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function makeColumn<T extends (string | number | Function)[]>(\n  builder: (...args: T) => TableColumn\n): (...args: T) => TableColumnDef {\n  const key = Math.random().toString();\n  const newBuilder = (...args: T) => {\n    const outer = () => {\n      const ret = builder(...args);\n      if (ret) {\n        return React.cloneElement(ret, { key });\n      }\n      return ret;\n    };\n    outer.key = key + args.join(\"-\");\n    return outer;\n  };\n  return newBuilder;\n}\n\nexport const COLUMN_GAMEMODE = makeColumn(\n  () =>\n    Conf.table.showGameMode && (\n      <Column\n        dataKey=\"modeId\"\n        label={isMobile() ? \"\" : <Trans>等级</Trans>}\n        cellRenderer={cellFormatGameMode}\n        width={isMobile() ? 20 : 40}\n        className=\"mobile-vertical\"\n      />\n    )\n)();\n\nexport const COLUMN_RANK = makeColumn((activePlayerId: number | string) => (\n  <Column\n    dataKey=\"modeId\"\n    label={isMobile() ? \"\" : <Trans>顺位</Trans>}\n    columnData={{ activePlayerId }}\n    cellRenderer={cellFormatRank}\n    width={isMobile() ? 20 : 40}\n  />\n));\n\nexport const COLUMN_PLAYERS = makeColumn((activePlayerId: ActivePlayerId) => (\n  <Column\n    dataKey=\"players\"\n    label={<Trans>玩家</Trans>}\n    cellRenderer={({ rowData }: TableCellProps) =>\n      rowData && rowData.players ? (\n        <Players game={rowData} activePlayerId={activePlayerId} language={i18n.language} />\n      ) : null\n    }\n    width={120}\n    flexGrow={1}\n  />\n));\n\nexport const COLUMN_STARTTIME = makeColumn(() => (\n  <Column\n    dataKey=\"startTime\"\n    label={<Trans>开始</Trans>}\n    cellRenderer={cellFormatTime}\n    width={isMobile() ? 40 : 50}\n    className=\"text-right\"\n    headerClassName=\"text-right\"\n  />\n))();\n\nexport const COLUMN_ENDTIME = makeColumn(() => (\n  <Column\n    dataKey=\"endTime\"\n    label={<Trans>结束</Trans>}\n    cellRenderer={cellFormatTime}\n    width={isMobile() ? 40 : 50}\n    headerClassName=\"text-right\"\n    className=\"text-right\"\n  />\n))();\n\nexport const COLUMN_FULLTIME = makeColumn(() => (\n  <Column\n    dataKey=\"startTime\"\n    label={<Trans>时间</Trans>}\n    cellRenderer={cellFormatFullTime}\n    width={isMobile() ? 40 : 150}\n    className=\"text-right\"\n    headerClassName=\"text-right\"\n  />\n))();\n\nexport default function GameRecordTable({\n  columns,\n  withActivePlayer = false,\n  alwaysShowDetailLink = false,\n}: {\n  columns: TableColumnDef[];\n  withActivePlayer?: boolean;\n  alwaysShowDetailLink?: boolean;\n}) {\n  const { i18n } = useTranslation();\n  const data = useDataAdapter();\n  const scrollerProps = useScrollerProps();\n  const { isScrolling, onChildScroll, scrollTop, height, registerChild } = scrollerProps;\n  const rowGetter = useCallback(({ index }: Index) => data.getItem(index), [data]);\n  const getRowClassName = useCallback(\n    ({ index }: Index) => (index >= 0 ? clsx({ loading: !data.isItemLoaded(index), even: (index & 1) === 0 }) : \"\"),\n    [data]\n  );\n  const noRowsRenderer = useCallback(() => (data.hasCount() ? null : <Loading />), [data]);\n  const unfilteredCount = data.getUnfilteredCount();\n  const shouldTriggerLayout = !!unfilteredCount;\n  useEffect(() => {\n    triggerRelayout();\n  }, [shouldTriggerLayout]);\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const memoColumns = useMemo(() => columns.map((x) => x()).filter((x) => x), [\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    isMobile(),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    i18n.language,\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    ...columns.map((x) => x.key || x),\n  ]);\n  if (data.hasCount() && !data.getCount()) {\n    return <></>;\n  }\n  return (\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    <div ref={registerChild as any} className=\"font-xs-adjust\">\n      <AutoSizer disableHeight>\n        {({ width }) => (\n          <Table\n            autoHeight\n            className={clsx(\n              withActivePlayer && \"with-active-player\",\n              alwaysShowDetailLink && \"always-show-detail-link\"\n            )}\n            rowCount={data.getCount()}\n            rowGetter={rowGetter}\n            rowHeight={getRowHeight()}\n            headerHeight={50}\n            width={width}\n            height={height}\n            isScrolling={isScrolling}\n            onScroll={onChildScroll}\n            scrollTop={scrollTop}\n            rowClassName={getRowClassName}\n            noRowsRenderer={noRowsRenderer}\n          >\n            {memoColumns}\n          </Table>\n        )}\n      </AutoSizer>\n    </div>\n  );\n}\n","import i18n from \"../../i18n\";\n\nconst t = i18n.getFixedT(null, \"gameModeShort\");\n\nexport enum GameMode {\n  王座 = 16,\n  玉 = 12,\n  金 = 9,\n  王座东 = 15,\n  玉东 = 11,\n  金东 = 8,\n  三金 = 22,\n  三玉 = 24,\n  三王座 = 26,\n  三金东 = 21,\n  三玉东 = 23,\n  三王座东 = 25,\n}\nexport function modeLabelNonTranslated(mode: GameMode) {\n  if (!mode) {\n    return \"全部\";\n  }\n  return GameMode[mode].replace(/^三/, \"\");\n}\nexport function modeLabel(mode: GameMode) {\n  return t(modeLabelNonTranslated(mode));\n}\nexport function parseCombinedMode(modeString?: string): GameMode[] {\n  return (modeString || \"\")\n    .split(\".\")\n    .map((x) => parseInt(x.trim(), 10) as GameMode)\n    .map((x) => (GameMode[x] ? x : (0 as GameMode)))\n    .filter((x) => x);\n}\n","/* eslint-disable @typescript-eslint/no-empty-function */\r\nimport dayjs from \"dayjs\";\r\nimport React, { useReducer, useContext, ReactChild, useMemo } from \"react\";\r\nimport { useHistory } from \"react-router\";\r\nimport { useEventCallback } from \"../../utils\";\r\nimport { generatePath } from \"./routes\";\r\nimport { GameMode } from \"../../data/types\";\r\n\r\nexport interface ListingModel {\r\n  type: undefined;\r\n  date: dayjs.ConfigType | null;\r\n  selectedMode: GameMode | null;\r\n  searchText: string;\r\n}\r\nexport interface PlayerModel {\r\n  type: \"player\";\r\n  playerId: string;\r\n  startDate: dayjs.ConfigType | null;\r\n  endDate: dayjs.ConfigType | null;\r\n  selectedModes: GameMode[];\r\n  searchText: string;\r\n  rank: number | null;\r\n}\r\nexport type Model = ListingModel | PlayerModel;\r\n// eslint-disable-next-line @typescript-eslint/no-redeclare\r\nexport const Model = Object.freeze({\r\n  removeExtraParams(model: Model): Model {\r\n    if (model.type === \"player\") {\r\n      return {\r\n        type: \"player\",\r\n        playerId: model.playerId,\r\n        selectedModes: [],\r\n        startDate: null,\r\n        endDate: null,\r\n        searchText: \"\",\r\n        rank: null,\r\n      };\r\n    }\r\n    return {\r\n      type: undefined,\r\n      searchText: \"\",\r\n      selectedMode: null,\r\n      date: null,\r\n    };\r\n  },\r\n});\r\ntype ModelUpdate = Partial<ListingModel> | ({ type: \"player\" } & Partial<PlayerModel>);\r\ntype DispatchModelUpdate = (props: ModelUpdate) => void;\r\n\r\nconst DEFAULT_MODEL: ListingModel = { type: undefined, date: null, selectedMode: null, searchText: \"\" };\r\nconst ModelContext = React.createContext<[Readonly<Model>, DispatchModelUpdate]>([DEFAULT_MODEL, () => {}]);\r\nexport const useModel = () => useContext(ModelContext);\r\n\r\nfunction normalizeUpdate(newProps: ModelUpdate): ModelUpdate {\r\n  if (newProps.type === undefined) {\r\n    if (newProps.date) {\r\n      newProps.date = dayjs(newProps.date).valueOf();\r\n    }\r\n  }\r\n  for (const key of Object.keys(newProps)) {\r\n    if (key !== \"type\" && newProps[key as keyof typeof newProps] === undefined) {\r\n      delete newProps[key as keyof typeof newProps];\r\n    }\r\n  }\r\n  return newProps;\r\n}\r\nfunction isSameModel(a: Model, b: Model): boolean {\r\n  return generatePath(a) === generatePath(b);\r\n}\r\n\r\nconst OnRouteModelUpdatedContext = React.createContext((() => {}) as (model: Model) => void);\r\nexport const useOnRouteModelUpdated = () => useContext(OnRouteModelUpdatedContext);\r\n\r\nexport function ModelProvider({ children }: { children: ReactChild | ReactChild[] }) {\r\n  const history = useHistory();\r\n  const [model, setModel] = useReducer(\r\n    (oldModel: Model, newModel: Model): Readonly<Model> => {\r\n      if (isSameModel(oldModel, newModel)) {\r\n        return oldModel;\r\n      }\r\n      return Object.freeze(newModel);\r\n    },\r\n    undefined,\r\n    () => Object.freeze(DEFAULT_MODEL as Model)\r\n  );\r\n  const dispatchModelUpdate = useEventCallback(\r\n    (newProps: ModelUpdate) => {\r\n      const newModel = {\r\n        ...((model.type === newProps.type ? model : {}) as Model),\r\n        ...(normalizeUpdate(newProps) as Model),\r\n      };\r\n      if (newModel.type === \"player\" && (!newModel.selectedModes || !newModel.selectedModes.length)) {\r\n        if (\r\n          model.type === undefined &&\r\n          model.selectedMode &&\r\n          (!newModel.selectedModes || !newModel.selectedModes.length)\r\n        ) {\r\n          newModel.selectedModes = [model.selectedMode];\r\n        } else {\r\n          newModel.selectedModes = [];\r\n        }\r\n      }\r\n      if (isSameModel(model, newModel)) {\r\n        return;\r\n      }\r\n      history.replace(generatePath(newModel));\r\n    },\r\n    [model, history]\r\n  );\r\n  const value = useMemo(() => [model, dispatchModelUpdate] as [Readonly<Model>, DispatchModelUpdate], [\r\n    model,\r\n    dispatchModelUpdate,\r\n  ]);\r\n  return (\r\n    <ModelContext.Provider value={value}>\r\n      <OnRouteModelUpdatedContext.Provider value={setModel}>{children}</OnRouteModelUpdatedContext.Provider>\r\n    </ModelContext.Provider>\r\n  );\r\n}\r\n","import React from \"react\";\nimport Loadable from \"react-loadable\";\nimport { LoadableComponent, Options } from \"react-loadable\";\n\n// eslint-disable-next-line @typescript-eslint/ban-types\nfunction CustomizedLoadable<Props, Exports extends object>(\n  options: Options<Props, Exports>\n): React.ComponentType<Props> & LoadableComponent {\n  return Loadable<Props, Exports>({ delay: 200, ...options });\n}\n\nexport default CustomizedLoadable;\n","export const PLAYER_RANKS = \"初士杰豪圣魂\";\nexport const RANK_LABELS = [\"一位\", \"二位\", \"三位\", \"四位\"];\n","import React from \"react\";\nimport dayjs from \"dayjs\";\n\nimport { useParams, useLocation, Redirect } from \"react-router\";\nimport { Model, useOnRouteModelUpdated } from \"./model\";\nimport { useEffect } from \"react\";\nimport { scrollToTop, triggerRelayout } from \"../../utils/index\";\nimport Conf from \"../../utils/conf\";\nimport { parseCombinedMode } from \"../../data/types\";\n\ntype ListingRouteParams = {\n  date?: string;\n  mode?: string;\n  search?: string;\n};\n\ntype PlayerRouteParams = {\n  id: string;\n  startDate?: string;\n  endDate?: string;\n  mode?: string;\n  search?: string;\n  rank?: string;\n};\n\nfunction parseOptionalDate<T>(s: string | null | undefined, defaultValue: T): dayjs.Dayjs | T {\n  return s ? dayjs(s, \"YYYY-MM-DD\") : defaultValue;\n}\n\nconst ModelBuilders = {\n  player(params: PlayerRouteParams): Model | string {\n    if (params.rank) {\n      const rank = parseInt(params.rank);\n      if (!rank || rank < 1 || rank > Conf.rankColors.length) {\n        delete params.rank;\n      }\n    }\n    return {\n      type: \"player\",\n      playerId: params.id,\n      startDate: parseOptionalDate(params.startDate, null),\n      endDate: parseOptionalDate(params.endDate, null),\n      selectedModes: parseCombinedMode(params.mode || \"\"),\n      searchText: params.search ? params.search.slice(1) : \"\",\n      rank: parseInt(params.rank || \"\") || null,\n    };\n  },\n  listing(params: ListingRouteParams): Model | string {\n    const date = parseOptionalDate(params.date, null);\n    if (date && !date.isValid()) {\n      return \"/\";\n    }\n    return {\n      type: undefined,\n      date: date ? date.startOf(\"day\").valueOf() : null,\n      selectedMode: parseCombinedMode(params.mode || \"\")[0] || null,\n      searchText: params.search || \"\",\n    };\n  },\n};\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function RouteSync({ view }: { view: keyof typeof ModelBuilders }): React.FunctionComponentElement<any> {\n  useEffect(() => {\n    triggerRelayout();\n    scrollToTop();\n    return scrollToTop;\n  }, []);\n  const onRouteModelUpdated = useOnRouteModelUpdated();\n  const params = useParams();\n  const location = useLocation();\n  const query = new URLSearchParams(location.search);\n  Object.assign(params, {\n    rank: query.get(\"rank\"),\n  });\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const modelResult = ModelBuilders[view](params as any);\n  useEffect(() => {\n    if (typeof modelResult !== \"string\") {\n      onRouteModelUpdated(modelResult);\n    }\n  }, [modelResult, onRouteModelUpdated]);\n  if (typeof modelResult === \"string\") {\n    return <Redirect to={modelResult} />;\n  }\n  return <></>;\n}\n","import { useCallback } from \"react\";\r\nimport React from \"react\";\r\n\r\nimport { FormRow, DatePicker } from \"../form\";\r\nimport { useModel } from \"./model\";\r\nimport dayjs from \"dayjs\";\r\nimport { ModeSelector } from \"./modeSelector\";\r\nimport Conf from \"../../utils/conf\";\r\nimport { GameMode } from \"../../data/types\";\r\n\r\nconst DEFAULT_DATE = dayjs().startOf(\"day\");\r\n\r\nexport function FilterPanel() {\r\n  const [model, updateModel] = useModel();\r\n  const setMode = useCallback((mode: GameMode[]) => updateModel({ selectedMode: mode[0] || null }), [updateModel]);\r\n  const setDate = useCallback((date: dayjs.ConfigType) => updateModel({ date }), [updateModel]);\r\n  if (model.type !== undefined) {\r\n    return null;\r\n  }\r\n  return (\r\n    <>\r\n      <FormRow title=\"日期\">\r\n        <DatePicker min={Conf.dateMin} date={model.date || DEFAULT_DATE} onChange={setDate} className=\"form-control\" />\r\n      </FormRow>\r\n      {Conf.availableModes.length > 1 && (\r\n        <FormRow>\r\n          <ModeSelector mode={model.selectedMode ? [model.selectedMode] : []} onChange={setMode} />\r\n        </FormRow>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n","import React from \"react\";\nimport { useEffect, useState, useMemo } from \"react\";\n\nimport Loading from \"../misc/loading\";\nimport { PlayerMetadataLite, getLevelTag } from \"../../data/types\";\nimport { searchPlayer } from \"../../data/source/misc\";\nimport { Link } from \"react-router-dom\";\nimport { generatePlayerPathById } from \"./routes\";\nimport { useTranslation } from \"react-i18next\";\n\nconst playerSearchCache = {} as { [prefix: string]: PlayerMetadataLite[] | Promise<PlayerMetadataLite[]> };\nconst NUM_RESULTS_SHOWN = 6;\nconst NUM_FETCH = 20;\n\nconst normalizeName = (s: string) => s.toLowerCase().trim();\n\nfunction findRawResultFromCache(prefix: string): { result: PlayerMetadataLite[]; isExactMatch: boolean } | null {\n  const normalizedPrefix = normalizeName(prefix);\n  prefix = normalizedPrefix;\n  while (prefix) {\n    const players = playerSearchCache[prefix];\n    if (!players || players instanceof Promise) {\n      prefix = prefix.slice(0, prefix.length - 1);\n      continue;\n    }\n    return {\n      isExactMatch: prefix === normalizedPrefix,\n      result: players,\n    };\n  }\n  return null;\n}\n\nfunction PlayerSearchResult({ searchText }: { searchText: string }) {\n  const { t } = useTranslation();\n  const [version, setVersion] = useState(0);\n  const [players, isLoading, mayHaveMore] = useMemo(() => {\n    const cachedResult = findRawResultFromCache(searchText);\n    if (!cachedResult) {\n      return [[], true];\n    }\n    if (cachedResult.isExactMatch) {\n      return [cachedResult.result, false];\n    }\n    const normalizedPrefix = normalizeName(searchText);\n    let mayHaveMore = cachedResult.result.length >= NUM_FETCH;\n    const filteredPlayers = [] as PlayerMetadataLite[];\n    cachedResult.result.forEach((player) => {\n      if (normalizeName(player.nickname).startsWith(normalizedPrefix)) {\n        filteredPlayers.push(player);\n      } else if (filteredPlayers.length) {\n        // Result covers all players who have the specified prefix\n        mayHaveMore = false;\n      }\n    });\n    return [filteredPlayers, mayHaveMore && filteredPlayers.length < NUM_RESULTS_SHOWN, mayHaveMore];\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [searchText, version]);\n  useEffect(() => {\n    const prefix = normalizeName(searchText);\n    if (playerSearchCache[prefix]) {\n      return;\n    }\n    if (!isLoading) {\n      return;\n    }\n    let cancelled = false;\n    let debounceToken: ReturnType<typeof setTimeout> | undefined = setTimeout(() => {\n      debounceToken = undefined;\n      if (cancelled) {\n        return;\n      }\n      if (playerSearchCache[prefix]) {\n        return;\n      }\n      playerSearchCache[prefix] = searchPlayer(prefix).then(function (players) {\n        playerSearchCache[prefix] = players;\n        if (!cancelled) {\n          setVersion(new Date().getTime());\n        }\n        return players;\n      });\n    }, 500);\n    return () => {\n      cancelled = true;\n      if (debounceToken) {\n        clearTimeout(debounceToken);\n      }\n    };\n  }, [searchText, isLoading]);\n  return (\n    <>\n      <ul className=\"list-unstyled mb-2\">\n        {players.slice(0, NUM_RESULTS_SHOWN).map((x) => (\n          <li key={x.id}>\n            <Link to={generatePlayerPathById(x.id)}>\n              <span>\n                [{getLevelTag(x.level.id)}] {x.nickname}\n              </span>\n            </Link>\n          </li>\n        ))}\n      </ul>\n      {(isLoading && <Loading size=\"small\" />) ||\n        ((players.length > NUM_RESULTS_SHOWN || mayHaveMore) && (\n          <small className=\"d-block text-center text-muted\">{t(\"（输入更长名字显示其它结果）\")}</small>\n        ))}\n    </>\n  );\n}\n\nexport function PlayerSearch({ className = \"player-search\", searchText = \"\" }) {\n  if (!searchText) {\n    return <></>;\n  }\n  return (\n    <div className={className}>\n      <PlayerSearchResult searchText={searchText} />\n    </div>\n  );\n}\n","import React, { useState } from \"react\";\n\nimport { Switch, Route, Redirect, generatePath as genPath } from \"react-router-dom\";\nimport { useTranslation } from \"react-i18next\";\n\nimport { Model, useModel } from \"./model\";\nimport dayjs from \"dayjs\";\nimport { RouteSync } from \"./routeSync\";\nimport { FilterPanel } from \"./filterPanel\";\nimport Loadable from \"../misc/customizedLoadable\";\nimport Loading from \"../misc/loading\";\nimport { PlayerSearch } from \"./playerSearch\";\nimport { COLUMN_RANK } from \"./table\";\nimport {\n  default as GameRecordTable,\n  COLUMN_GAMEMODE,\n  COLUMN_PLAYERS,\n  COLUMN_STARTTIME,\n  COLUMN_ENDTIME,\n  COLUMN_FULLTIME,\n} from \"./table\";\nimport { PageCategory } from \"../misc/tracker\";\nimport { FormRow } from \"../form\";\nconst PlayerDetails = Loadable({\n  loader: () => import(\"../playerDetails/playerDetails\"),\n  loading: () => <Loading />,\n});\n\nconst PLAYER_PATH =\n  \"/player/:id/:mode([0-9.]+)?/:search(-[^/]+)?/:startDate(\\\\d{4}-\\\\d{2}-\\\\d{2})?/:endDate(\\\\d{4}-\\\\d{2}-\\\\d{2})?\";\nconst PATH = \"/:date(\\\\d{4}-\\\\d{2}-\\\\d{2})/:mode([0-9]+)?/:search?\";\n\nfunction dateToStringSafe(value: dayjs.ConfigType | null | undefined): string | undefined {\n  if (!value) {\n    return undefined;\n  }\n  const dateObj = dayjs(value);\n  if (!dateObj.isValid() || dateObj.year() < 2019 || dateObj.year() > 9999) {\n    return undefined;\n  }\n  return dateObj.format(\"YYYY-MM-DD\");\n}\n\nexport function generatePath(model: Model): string {\n  if (model.type === \"player\") {\n    let result = genPath(PLAYER_PATH, {\n      id: model.playerId,\n      startDate: dateToStringSafe(model.startDate),\n      endDate: dateToStringSafe(model.endDate),\n      mode: model.selectedModes.join(\".\") || undefined,\n      search: model.searchText ? \"-\" + model.searchText : undefined,\n    });\n    if (model.rank) {\n      result += `?rank=${model.rank}`;\n    }\n    return result;\n  }\n  if (!model.selectedMode && !model.searchText && !model.date) {\n    return \"/\";\n  }\n  const dateString = dateToStringSafe(model.date || new Date());\n  if (!dateString) {\n    return \"/\";\n  }\n  return genPath(PATH, {\n    date: dateString,\n    mode: model.selectedMode || undefined,\n    search: model.searchText || undefined,\n  });\n}\nexport function generatePlayerPathById(playerId: number | string): string {\n  return generatePath({\n    type: \"player\",\n    playerId: playerId.toString(),\n    startDate: null,\n    endDate: null,\n    selectedModes: [],\n    searchText: \"\",\n    rank: null,\n  });\n}\n\nfunction GameRecordTablePlayerView() {\n  const [model] = useModel();\n  if (!(\"playerId\" in model)) {\n    return null;\n  }\n  return (\n    <GameRecordTable\n      withActivePlayer\n      columns={[COLUMN_GAMEMODE, COLUMN_RANK(model.playerId), COLUMN_PLAYERS(model.playerId), COLUMN_FULLTIME]}\n    />\n  );\n}\n\nfunction Routes() {\n  const { t } = useTranslation(\"formRow\");\n  const [searchText, setSearchText] = useState(\"\");\n  return (\n    <Switch>\n      <Route path={PLAYER_PATH}>\n        <RouteSync view=\"player\" />\n        <PageCategory category=\"Player\" />\n        <PlayerDetails />\n        <GameRecordTablePlayerView />\n      </Route>\n      <Route exact path={[\"/\", PATH]}>\n        <RouteSync view=\"listing\" />\n        <PageCategory category=\"Listing\" />\n        <h2 className=\"text-center mb-3\">{t(\"查找玩家\")}</h2>\n        <div className=\"home-header mb-5\">\n          <FormRow title=\"名字\">\n            <input\n              type=\"text\"\n              className=\"form-control\"\n              value={searchText}\n              onChange={(e) => setSearchText(e.currentTarget.value)}\n            />\n          </FormRow>\n          <PlayerSearch searchText={searchText} />\n        </div>\n        <h2 className=\"text-center mb-3\">{t(\"对局浏览\")}</h2>\n        <div className=\"home-header\">\n          <FilterPanel />\n        </div>\n        <GameRecordTable columns={[COLUMN_GAMEMODE, COLUMN_PLAYERS(\"\"), COLUMN_STARTTIME, COLUMN_ENDTIME]} />\n      </Route>\n      <Route>\n        <Redirect to=\"/\" />\n      </Route>\n    </Switch>\n  );\n}\nexport default Routes;\n","import React, { useMemo } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport clsx from \"clsx\";\r\nimport { useState } from \"react\";\r\n\r\nexport interface CheckboxItem<T> {\r\n  key: string;\r\n  label: string;\r\n  value: T;\r\n}\r\n\r\ntype GroupParams<T> = {\r\n  type: \"checkbox\" | \"radio\";\r\n  items: CheckboxItem<T>[];\r\n  groupKey: string;\r\n  selectedItems: Iterable<string | CheckboxItem<T>> | null;\r\n  onChange: (selectedItems: CheckboxItem<T>[]) => void;\r\n  i18nNamespace?: string | undefined;\r\n};\r\nexport function CheckboxGroup<T>(\r\n  props: GroupParams<T> = {\r\n    type: \"checkbox\",\r\n    items: [],\r\n    groupKey: \"default\",\r\n    selectedItems: null,\r\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\r\n    onChange: () => {},\r\n    i18nNamespace: undefined,\r\n  }\r\n) {\r\n  const { t } = useTranslation(props.i18nNamespace);\r\n  const [activeKey, setActiveKey] = useState(null as string | null);\r\n  const selectedItemKeys = useMemo(() => {\r\n    const ret = new Set<string>();\r\n    for (const item of props.selectedItems || []) {\r\n      if (typeof item === \"string\") {\r\n        ret.add(item);\r\n      } else {\r\n        ret.add(item.key);\r\n      }\r\n    }\r\n    return ret;\r\n  }, [props.selectedItems]);\r\n  const { type, items, groupKey, onChange } = props;\r\n  const { setSelected, selectSingle } = useMemo(() => {\r\n    if (props.type === \"checkbox\") {\r\n      return {\r\n        setSelected(key: string, isSelected: boolean) {\r\n          if (isSelected && selectedItemKeys.has(key)) {\r\n            return;\r\n          }\r\n          if (!isSelected && !selectedItemKeys.has(key)) {\r\n            return;\r\n          }\r\n          const newSet = new Set(selectedItemKeys || items.map((x) => x.key));\r\n          if (isSelected) {\r\n            newSet.add(key);\r\n          } else {\r\n            newSet.delete(key);\r\n          }\r\n          onChange(items.filter((x) => newSet.has(x.key)));\r\n        },\r\n        selectSingle(key: string) {\r\n          if (selectedItemKeys.size === 1 && selectedItemKeys.has(key)) {\r\n            return;\r\n          }\r\n          onChange(items.filter((x) => x.key === key));\r\n        },\r\n      };\r\n    } else {\r\n      return {\r\n        setSelected(key: string, isSelected: boolean) {\r\n          if (!isSelected) {\r\n            return;\r\n          }\r\n          const item = items.find((x) => x.key === key);\r\n          onChange(item ? [item] : []);\r\n        },\r\n        selectSingle(key: string) {\r\n          setSelected(key, true);\r\n        },\r\n      };\r\n    }\r\n  }, [items, onChange, props.type, selectedItemKeys]);\r\n  return (\r\n    <div className={clsx(\"checkbox-group\", \"checkbox-group-\" + type, activeKey && \"checkbox-group-has-active\")}>\r\n      {items.map((item) => (\r\n        <div className={clsx(\"form-check form-check-inline\", activeKey === item.key && \"active\")} key={item.key}>\r\n          <input\r\n            className=\"form-check-input\"\r\n            type={type}\r\n            id={`CG_${groupKey}_${item.key}`}\r\n            name={`CG_${groupKey}_${item.key}`}\r\n            value={item.key}\r\n            checked={selectedItemKeys.has(item.key)}\r\n            onChange={(event) => setSelected(item.key, event.currentTarget.checked)}\r\n          />\r\n          <label\r\n            className=\"form-check-label\"\r\n            htmlFor={`CG_${groupKey}_${item.key}`}\r\n            onMouseEnter={() => setActiveKey(item.key)}\r\n            onMouseLeave={() => (activeKey === item.key ? setActiveKey(null) : undefined)}\r\n            onClick={(e) => {\r\n              e.preventDefault();\r\n              e.stopPropagation();\r\n              selectSingle(item.key);\r\n            }}\r\n          >\r\n            {t(item.label)}\r\n          </label>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n","/* eslint-disable @typescript-eslint/no-empty-function */\r\nimport React from \"react\";\r\n\r\nimport dayjs from \"dayjs\";\r\nimport { useCallback } from \"react\";\r\n\r\nexport function DatePicker({\r\n  date = dayjs() as dayjs.ConfigType,\r\n  onChange = (() => {}) as (_: dayjs.Dayjs) => void,\r\n  className = \"\",\r\n  min = 0 as dayjs.ConfigType,\r\n  max = dayjs() as dayjs.ConfigType\r\n}) {\r\n  const handleChange = useCallback(\r\n    (e: React.ChangeEvent<HTMLInputElement>) => onChange(dayjs(e.currentTarget.value, \"YYYY-MM-DD\")),\r\n    [onChange]\r\n  );\r\n  return (\r\n    <input\r\n      className={className}\r\n      type=\"date\"\r\n      value={dayjs(date).format(\"YYYY-MM-DD\")}\r\n      min={min ? dayjs(min).format(\"YYYY-MM-DD\") : undefined}\r\n      max={max ? dayjs(max).format(\"YYYY-MM-DD\") : undefined}\r\n      onChange={handleChange}\r\n    />\r\n  );\r\n}\r\n","import { useLocation } from \"react-router\";\nimport React, { useEffect, useLayoutEffect } from \"react\";\nimport Helmet from \"react-helmet\";\nimport Conf from \"../../utils/conf\";\n\nlet currentCategory = \"Home\";\n\ntype Ga = NonNullable<typeof window.ga>;\n\ndeclare global {\n  interface Window {\n    __loadGa?: () => Ga;\n  }\n}\n\nexport function PageCategory({ category }: { category: string }) {\n  useLayoutEffect(() => {\n    const oldCategory = currentCategory;\n    currentCategory = category;\n    return () => {\n      currentCategory = oldCategory;\n    };\n  }, [category]);\n  return null;\n}\n\nfunction TrackerImpl() {\n  const loc = useLocation();\n  useEffect(() => {\n    let cancelled = false;\n    window.requestAnimationFrame(() => {\n      if (cancelled) {\n        return;\n      }\n      const helmet = Helmet.peek();\n      const title = (helmet.title || document.title).toString();\n      window.ga(\"send\", {\n        hitType: \"pageview\",\n        page: loc.pathname,\n        title: `${currentCategory} ${title}`,\n        contentGroup1: currentCategory\n      });\n    });\n    return () => {\n      cancelled = true;\n    };\n  }, [loc.pathname]);\n  return null;\n}\n\nexport default function Tracker() {\n  if (process.env.NODE_ENV !== \"production\") {\n    return null;\n  }\n  if (window.location.host !== Conf.canonicalDomain) {\n    return null;\n  }\n  if (!window.__loadGa) {\n    return null;\n  }\n  window.__loadGa();\n  return <TrackerImpl />;\n}\n","export * from \"./constants\";\nexport * from \"./gameMode\";\nexport * from \"./level\";\nexport * from \"./metadata\";\nexport * from \"./record\";\nexport * from \"./ranking\";\nexport * from \"./statistics\";\nexport * from \"./utils\";\nexport * from \"./zone\";\n","import { GameMode } from \"./gameMode\";\nimport { PLAYER_RANKS } from \"./constants\";\nimport i18n from \"../../i18n\";\n\nconst t = i18n.t.bind(i18n);\n\nconst LEVEL_MAX_POINTS = [20, 80, 200, 600, 800, 1000, 1200, 1400, 2000, 2800, 3200, 3600, 4000, 6000, 9000];\nconst LEVEL_PENALTY = [0, 0, 0, 20, 40, 60, 80, 100, 120, 165, 180, 195, 210, 225, 240, 255];\nconst LEVEL_PENALTY_3 = [0, 0, 0, 20, 40, 60, 80, 100, 120, 165, 190, 215, 240, 265, 290, 320];\nconst LEVEL_PENALTY_E = [0, 0, 0, 10, 20, 30, 40, 50, 60, 80, 90, 100, 110, 120, 130, 140];\nconst LEVEL_PENALTY_E_3 = [0, 0, 0, 10, 20, 30, 40, 50, 60, 80, 95, 110, 125, 140, 160, 175];\n\nconst LEVEL_ALLOWED_MODES: { [key: number]: GameMode[] } = {\n  101: [],\n  102: [],\n  103: [GameMode.金, GameMode.金东],\n  104: [GameMode.金, GameMode.玉, GameMode.金东, GameMode.玉东],\n  105: [GameMode.玉, GameMode.王座, GameMode.玉东, GameMode.王座东],\n  106: [GameMode.王座, GameMode.王座东],\n  201: [],\n  202: [],\n  203: [GameMode.三金, GameMode.三金东],\n  204: [GameMode.三金, GameMode.三玉, GameMode.三金东, GameMode.三玉东],\n  205: [GameMode.三玉, GameMode.三王座, GameMode.三玉东, GameMode.三王座东],\n  206: [GameMode.三王座, GameMode.三王座东],\n};\n\nconst MODE_PENALTY: { [mode in GameMode]: typeof LEVEL_PENALTY } = {\n  [GameMode.金]: LEVEL_PENALTY,\n  [GameMode.玉]: LEVEL_PENALTY,\n  [GameMode.王座]: LEVEL_PENALTY,\n  [GameMode.金东]: LEVEL_PENALTY_E,\n  [GameMode.玉东]: LEVEL_PENALTY_E,\n  [GameMode.王座东]: LEVEL_PENALTY_E,\n  [GameMode.三金]: LEVEL_PENALTY_3,\n  [GameMode.三玉]: LEVEL_PENALTY_3,\n  [GameMode.三王座]: LEVEL_PENALTY_3,\n  [GameMode.三金东]: LEVEL_PENALTY_E_3,\n  [GameMode.三玉东]: LEVEL_PENALTY_E_3,\n  [GameMode.三王座东]: LEVEL_PENALTY_E_3\n};\n\nexport function getTranslatedLevelTags(): string[] {\n  const rawTags = t(PLAYER_RANKS) as string;\n  if (rawTags.charCodeAt(0) > 127) {\n    return rawTags.split(\"\");\n  }\n  return Array(rawTags.length / 2)\n    .fill(\"\")\n    .map((_, index) => rawTags.slice(index * 2, index * 2 + 2));\n}\n\nexport class Level {\n  _majorRank: number;\n  _minorRank: number;\n  _numPlayerId: number;\n  constructor(levelId: number) {\n    const realId = levelId % 10000;\n    this._majorRank = Math.floor(realId / 100);\n    this._minorRank = realId % 100;\n    this._numPlayerId = Math.floor(levelId / 10000);\n  }\n  isSameMajorRank(other: Level): boolean {\n    return this._majorRank === other._majorRank;\n  }\n  isSame(other: Level): boolean {\n    return this._majorRank === other._majorRank && this._minorRank === other._minorRank;\n  }\n  isAllowedMode(mode: GameMode): boolean {\n    return LEVEL_ALLOWED_MODES[this._numPlayerId * 100 + this._majorRank].includes(mode);\n  }\n  getTag(): string {\n    const label = getTranslatedLevelTags()[this._majorRank - 1];\n    if (this._majorRank === PLAYER_RANKS.length) {\n      return label;\n    }\n    return label + this._minorRank;\n  }\n  getMaxPoint(): number {\n    return LEVEL_MAX_POINTS[(this._majorRank - 1) * 3 + this._minorRank - 1];\n  }\n  getPenaltyPoint(mode: GameMode): number {\n    return MODE_PENALTY[mode][(this._majorRank - 1) * 3 + this._minorRank - 1];\n  }\n  getStartingPoint(): number {\n    if (this._majorRank === 1) {\n      return 0;\n    }\n    if (this._majorRank === PLAYER_RANKS.length) {\n      return 10000;\n    }\n    return this.getMaxPoint() / 2;\n  }\n  getNextLevel(): Level {\n    if (this._majorRank === PLAYER_RANKS.length) {\n      return this;\n    }\n    let majorRank = this._majorRank;\n    let minorRank = this._minorRank + 1;\n    if (minorRank > 3) {\n      majorRank++;\n      minorRank = 1;\n    }\n    return new Level(this._numPlayerId * 10000 + majorRank * 100 + minorRank);\n  }\n  getPreviousLevel(): Level {\n    if (this._majorRank === 1 && this._minorRank === 1) {\n      return this;\n    }\n    let majorRank = this._majorRank;\n    let minorRank = this._minorRank - 1;\n    if (minorRank < 1) {\n      majorRank--;\n      minorRank = 3;\n    }\n    return new Level(this._numPlayerId * 10000 + majorRank * 100 + minorRank);\n  }\n  getAdjustedLevel(score: number): Level {\n    let maxPoints = this.getMaxPoint();\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    let level: Level = this;\n    if (maxPoints && score >= maxPoints) {\n      level = this.getNextLevel();\n      maxPoints = level.getMaxPoint();\n      score = level.getStartingPoint();\n    } else if (score < 0) {\n      if (!maxPoints || level._majorRank === 1 || (level._majorRank === 2 && level._minorRank === 1)) {\n        score = 0;\n      } else {\n        level = this.getPreviousLevel();\n        maxPoints = level.getMaxPoint();\n        score = level.getStartingPoint();\n      }\n    }\n    return level;\n  }\n  formatAdjustedScoreWithTag(score: number) {\n    const level = this.getAdjustedLevel(score);\n    return `${level.getTag()} ${this.formatAdjustedScore(score)}`;\n  }\n  formatAdjustedScore(score: number) {\n    const level = this.getAdjustedLevel(score);\n    return `${level === this ? Math.max(score, 0) : level.getStartingPoint()}${\n      level.getMaxPoint() ? \"/\" + level.getMaxPoint() : \"\"\n    }`;\n  }\n}\nexport function getLevelTag(levelId: number) {\n  return new Level(levelId).getTag();\n}\nexport type LevelWithDelta = {\n  id: number;\n  score: number;\n  delta: number;\n};\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const LevelWithDelta = Object.freeze({\n  format(obj: LevelWithDelta): string {\n    return new Level(obj.id).formatAdjustedScoreWithTag(obj.score + obj.delta);\n  },\n  formatAdjustedScore(obj: LevelWithDelta): string {\n    return new Level(obj.id).formatAdjustedScore(obj.score + obj.delta);\n  },\n  getTag(obj: LevelWithDelta): string {\n    return LevelWithDelta.getAdjustedLevel(obj).getTag();\n  },\n  getAdjustedLevel(obj: LevelWithDelta): Level {\n    return new Level(obj.id).getAdjustedLevel(obj.score + obj.delta);\n  },\n});\n","const implPromise = import(\"./notifyImpl\");\n\nexport const error = function (message: string) {\n  return implPromise.then((x) => x.error(message));\n};\n\nexport default { error };\n","import { useState, useEffect, useMemo, useCallback, useContext } from \"react\";\nimport React, { ReactChild } from \"react\";\nimport dayjs from \"dayjs\";\n\nimport { DataProvider, FilterPredicate } from \"../../data/source/records/provider\";\nimport { useModel, Model } from \"./model\";\nimport { Metadata, GameRecord } from \"../../data/types\";\nimport { generatePath } from \"./routes\";\nimport notify from \"../../utils/notify\";\nimport { useTranslation } from \"react-i18next\";\nimport { ApiError } from \"../../data/source/api\";\n\ninterface ItemLoadingPlaceholder {\n  loading: boolean;\n}\n\nconst loadingPlaceholder = { loading: true };\n\nexport interface IDataAdapter {\n  getCount(): number;\n  hasCount(): boolean;\n  getUnfilteredCount(): number;\n  getMetadata<T extends Metadata>(): T | null;\n  getItem(index: number): GameRecord | ItemLoadingPlaceholder;\n  isItemLoaded(index: number): boolean;\n}\n\nclass DummyDataAdapter implements IDataAdapter {\n  getCount(): number {\n    return 0;\n  }\n  hasCount(): boolean {\n    return true;\n  }\n  getUnfilteredCount(): number {\n    return 0;\n  }\n  getMetadata<T extends Metadata>(): T | null {\n    return null;\n  }\n  getItem(): GameRecord | ItemLoadingPlaceholder {\n    return loadingPlaceholder;\n  }\n  isItemLoaded(): boolean {\n    return false;\n  }\n}\n\nexport const DUMMY_DATA_ADAPTER = new DummyDataAdapter() as IDataAdapter;\n\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nconst noop = () => {};\n\nclass DataAdapter implements IDataAdapter {\n  _provider: DataProvider;\n  _onDataUpdate: (error: Error | ApiError | false) => void;\n  _triggeredRequest: boolean;\n\n  constructor(provider: DataProvider, onDataUpdate = noop) {\n    this._provider = provider;\n    this._onDataUpdate = onDataUpdate;\n    this._triggeredRequest = false;\n  }\n  _installHook<T>(promise: Promise<T>) {\n    if (this._triggeredRequest) {\n      return;\n    }\n    this._triggeredRequest = true;\n    promise.then(() => this._callHook(false)).catch((reason) => this._callHook(reason));\n  }\n  _callHook(error: Error | ApiError | false) {\n    setTimeout(() => {\n      this._onDataUpdate(error);\n      this._onDataUpdate = noop;\n    }, 0);\n  }\n  getCount(): number {\n    try {\n      const maybeCount = this._provider.getCountMaybeSync();\n      if (maybeCount instanceof Promise) {\n        this._installHook(maybeCount);\n        return 0;\n      }\n      return maybeCount;\n    } catch (e) {\n      this._callHook(e);\n      return 0;\n    }\n  }\n  hasCount(): boolean {\n    try {\n      return !(this._provider.getCountMaybeSync() instanceof Promise);\n    } catch (e) {\n      this._callHook(e);\n      return false;\n    }\n  }\n  getUnfilteredCount(): number {\n    try {\n      return this._provider.getUnfilteredCountSync() || 0;\n    } catch (e) {\n      this._callHook(e);\n      return 0;\n    }\n  }\n  getMetadata<T extends Metadata>(): T | null {\n    try {\n      return this._provider.getMetadataSync() as T | null;\n    } catch (e) {\n      this._callHook(e);\n      return null;\n    }\n  }\n  getItem(index: number): GameRecord | ItemLoadingPlaceholder {\n    if (index >= this.getCount()) {\n      return loadingPlaceholder;\n    }\n    if (this._provider.isItemLoaded(index)) {\n      return this._provider.getItem(index) as GameRecord;\n    }\n    if (!this._triggeredRequest) {\n      this._installHook(this._provider.getItem(index) as Promise<GameRecord>);\n    }\n    return loadingPlaceholder;\n  }\n  isItemLoaded(index: number): boolean {\n    if (index < 0) {\n      return false;\n    }\n    return this._provider.isItemLoaded(index);\n  }\n  setUpdateHook(hook: () => void) {\n    this._onDataUpdate = hook;\n  }\n  cancelUpdateHook() {\n    this._onDataUpdate = noop;\n  }\n}\n\nconst DataAdapterContext = React.createContext(DUMMY_DATA_ADAPTER);\n\nexport const useDataAdapter = () => useContext(DataAdapterContext);\nexport const DataAdapterConsumer = DataAdapterContext.Consumer;\n\nfunction getProviderKey(model: Model): string {\n  if (model.type === undefined) {\n    return `${dayjs(model.date || dayjs())\n      .startOf(\"day\")\n      .valueOf()\n      .toString()}_${model.selectedMode}`;\n  } else if (model.type === \"player\") {\n    return generatePath(model);\n  }\n  throw new Error(\"Unknown model type\");\n}\n\nfunction createProvider(model: Model): DataProvider {\n  if (model.type === undefined) {\n    return DataProvider.createListing(model.date || dayjs().startOf(\"day\"), model.selectedMode || null);\n  }\n  if (model.type === \"player\") {\n    return DataProvider.createPlayer(model.playerId, model.startDate, model.endDate, model.selectedModes);\n  }\n  throw new Error(\"Not implemented\");\n}\n\nfunction usePredicate(model: Model): FilterPredicate {\n  let memoFunc: () => FilterPredicate = () => null;\n  let memoDeps: React.DependencyList = [null, \"\", false];\n  const searchText = (model.searchText || \"\").trim().toLowerCase() || \"\";\n  const needPredicate = searchText || (\"rank\" in model && model.rank);\n  memoFunc = () =>\n    needPredicate\n      ? (game) => {\n          if (!game.players.some((player) => player.nickname.toLowerCase().indexOf(searchText) > -1)) {\n            return false;\n          }\n          if (\n            \"rank\" in model &&\n            model.rank &&\n            GameRecord.getRankIndexByPlayer(game, model.playerId) !== model.rank - 1\n          ) {\n            return false;\n          }\n          return true;\n        }\n      : null;\n  memoDeps = [(model.type === undefined && model.selectedMode) || null, searchText, \"rank\" in model && model.rank];\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  return useMemo(memoFunc, memoDeps);\n}\n\nfunction useDataAdapterCommon(\n  dataProvider: DataProvider,\n  onError: (error: Error | ApiError | false) => void,\n  deps: React.DependencyList\n) {\n  const [dataAdapter, setDataAdapter] = useState(() => DUMMY_DATA_ADAPTER);\n  const refreshDataAdapter = useCallback(\n    (error?: Error | ApiError | false) => {\n      if (error) {\n        onError(error);\n        return;\n      }\n      const adapter = new DataAdapter(dataProvider);\n      setDataAdapter(adapter);\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [dataProvider, onError, ...deps]\n  );\n  useEffect(refreshDataAdapter, [refreshDataAdapter]);\n  useEffect(() => {\n    const adapter = dataAdapter;\n    if (adapter instanceof DataAdapter) {\n      return () => adapter.cancelUpdateHook();\n    }\n  }, [dataAdapter]);\n  useEffect(() => {\n    const adapter = dataAdapter;\n    if (adapter instanceof DataAdapter) {\n      adapter.setUpdateHook(refreshDataAdapter);\n    }\n  }, [dataAdapter, refreshDataAdapter]);\n  useEffect(() => {\n    try {\n      // Preload metadata\n      const result = dataProvider.getCountMaybeSync();\n      if (result instanceof Promise) {\n        result.catch((e) => onError(e));\n      }\n    } catch (e) {\n      onError(e);\n    }\n  }, [dataProvider, onError]);\n  return {\n    dataAdapter,\n  };\n}\n\nexport function DataAdapterProvider({ children }: { children: ReactChild | ReactChild[] }) {\n  const [model, updateModel] = useModel();\n  const [dataProviders] = useState(() => ({} as { [key: string]: DataProvider }));\n  const searchPredicate = usePredicate(model);\n  const dataProvider = useMemo(() => {\n    const key = getProviderKey(model);\n    if (!dataProviders[key]) {\n      dataProviders[key] = createProvider(model);\n    }\n    return dataProviders[key];\n  }, [model, dataProviders]);\n  const { t } = useTranslation();\n  useEffect(() => dataProvider.setFilterPredicate(searchPredicate), [dataProvider, searchPredicate]);\n  const onError = useCallback(\n    (e) => {\n      if (e && \"status\" in e && e.status === 404) {\n        if (model.type === \"player\" && model.selectedModes.length) {\n          updateModel({ type: \"player\", playerId: model.playerId, selectedModes: [] });\n          return;\n        }\n      }\n      notify.error(t(\"加载数据失败\"));\n      // updateModel(Model.removeExtraParams(model));\n    },\n    [t, model, updateModel]\n  );\n  const { dataAdapter } = useDataAdapterCommon(dataProvider, onError, [model, searchPredicate]);\n  return <DataAdapterContext.Provider value={dataAdapter}>{children}</DataAdapterContext.Provider>;\n}\n\nexport function DataAdapterProviderCustom({\n  provider,\n  children,\n}: {\n  provider: DataProvider;\n  children: ReactChild | ReactChild[];\n}) {\n  const { dataAdapter } = useDataAdapterCommon(provider, noop, []);\n  return <DataAdapterContext.Provider value={dataAdapter}>{children}</DataAdapterContext.Provider>;\n}\n","import { useState, useEffect, ReactNode } from \"react\";\r\nimport React from \"react\";\r\nimport { ReactComponentLike } from \"prop-types\";\r\nimport { triggerRelayout } from \"../../utils/index\";\r\n\r\nexport function Alert({\r\n  className = \"\",\r\n  type = \"info\",\r\n  container = React.Fragment as ReactComponentLike,\r\n  stateName = \"\",\r\n  closable = true,\r\n  children = undefined as ReactNode\r\n}) {\r\n  const stateKey = `alertState_${stateName}`;\r\n  const [closed, setClosed] = useState(() => stateName && !!localStorage.getItem(stateKey));\r\n  useEffect(() => {\r\n    if (stateName && closed) {\r\n      localStorage.setItem(stateKey, \"true\");\r\n    }\r\n  }, [closed, stateName, stateKey]);\r\n  if (closed && closable) {\r\n    return null;\r\n  }\r\n  const Cont = container;\r\n  return (\r\n    <Cont>\r\n      <div className={`alert alert-${type} alert-dismissible fade show ${className}`} role=\"alert\">\r\n        {children}\r\n        {closable && (\r\n          <button\r\n            type=\"button\"\r\n            className=\"close\"\r\n            data-dismiss=\"alert\"\r\n            aria-label=\"Close\"\r\n            onClick={event => {\r\n              event.preventDefault();\r\n              setClosed(true);\r\n              triggerRelayout();\r\n            }}\r\n          >\r\n            <span aria-hidden=\"true\">×</span>\r\n          </button>\r\n        )}\r\n      </div>\r\n    </Cont>\r\n  );\r\n}\r\n","import i18n from \"../../i18n\";\nimport { RANK_LABELS } from \"./constants\";\n\nconst t = i18n.t.bind(i18n);\n\nexport function getRankLabelByIndex(index: number): string {\n  return t(RANK_LABELS[index]);\n}\n","import React, { ReactChild, useContext } from \"react\";\r\n\r\nimport { WindowScrollerChildProps } from \"react-virtualized\";\r\nimport { WindowScroller } from \"react-virtualized/dist/es/WindowScroller\";\r\n\r\nconst ScrollerContext = React.createContext<WindowScrollerChildProps>({} as WindowScrollerChildProps);\r\n\r\nexport const useScrollerProps = () => useContext(ScrollerContext);\r\n\r\nfunction Scroller({ children }: { children: ReactChild | ReactChild[] }) {\r\n  return (\r\n    <WindowScroller>\r\n      {scrollerProps => <ScrollerContext.Provider value={scrollerProps}>{children}</ScrollerContext.Provider>}\r\n    </WindowScroller>\r\n  );\r\n}\r\nexport default Scroller;\r\n","import dayjs from \"dayjs\";\n\nimport { GameRecord, GameRecordWithEvent } from \"../../types/record\";\nimport { Metadata, PlayerMetadata, PlayerExtendedStats } from \"../../types/metadata\";\nimport { apiGet } from \"../api\";\nimport { GameMode } from \"../../types\";\nimport Conf from \"../../../utils/conf\";\n\nconst CHUNK_SIZE = 100;\n\nexport interface DataLoader<T extends Metadata, TRecord = GameRecord> {\n  getMetadata(): Promise<T>;\n  getNextChunk(): Promise<TRecord[]>;\n  getEstimatedChunkSize(): number;\n}\n\nexport class RecentHighlightDataLoader implements DataLoader<Metadata> {\n  _data: Promise<GameRecord[]>;\n  _index: number;\n  constructor(mode: GameMode | undefined, numItems = 100) {\n    this._index = 0;\n    this._data = apiGet<GameRecordWithEvent[]>(`recent_highlight_games?limit=${numItems}&mode=${mode || \"\"}`)\n      .then((data) => {\n        if (data.every((x) => x.uuid)) {\n          return data;\n        }\n        return apiGet<GameRecordWithEvent[]>(`games_by_id/${data.map((x) => x._id).join(\",\")}`).then((records) => {\n          const recordMap = {} as { [key: string]: GameRecordWithEvent };\n          records.forEach((x) => (recordMap[x._id || \"\"] = x));\n          return data.map((x) => ({ ...x, ...recordMap[x._id || \"\"] }));\n        });\n      })\n      .then((data) => data.sort((a, b) => b.startTime - a.startTime))\n      .catch((e) => {\n        if (e.status === 404) {\n          return [];\n        }\n        return Promise.reject(e);\n      });\n  }\n  getEstimatedChunkSize() {\n    return CHUNK_SIZE;\n  }\n  async getMetadata(): Promise<Metadata> {\n    return this._data.then((x) => ({ count: x.length }));\n  }\n  async getNextChunk(): Promise<GameRecord[]> {\n    const index = this._index;\n    this._index += CHUNK_SIZE;\n    return this._data.then((data) => data.slice(index, index + CHUNK_SIZE));\n  }\n}\n\nexport class ListingDataLoader implements DataLoader<Metadata> {\n  _date: dayjs.Dayjs;\n  _cursor: dayjs.Dayjs;\n  _modeString: string;\n  constructor(date: dayjs.ConfigType, mode: GameMode | null) {\n    this._date = dayjs(date).startOf(\"day\");\n    const cursor = Math.floor(new Date().getTime() / 120000) * 120000;\n    this._cursor = dayjs(Math.min(this._date.clone().add(1, \"day\").valueOf() - 1, cursor));\n    this._modeString = mode && mode.toString() !== \"0\" ? mode.toString() : \"\";\n  }\n  getEstimatedChunkSize() {\n    return CHUNK_SIZE;\n  }\n  shouldReturnEmptyResult() {\n    return !this._modeString && Conf.availableModes.length > 1;\n  }\n  async getMetadata(): Promise<Metadata> {\n    if (this.shouldReturnEmptyResult()) {\n      return { count: 0 };\n    }\n    return { count: +Infinity };\n  }\n  async getNextChunk(): Promise<GameRecord[]> {\n    if (this._cursor.isBefore(this._date) || this._cursor.isSame(this._date) || this.shouldReturnEmptyResult()) {\n      return [];\n    }\n    const chunk = await apiGet<GameRecord[]>(\n      `games/${this._cursor.valueOf()}/${this._date.valueOf()}?limit=${CHUNK_SIZE}&descending=true&mode=${\n        this._modeString\n      }`\n    );\n    if (chunk.length) {\n      this._cursor = dayjs(chunk[chunk.length - 1].startTime * 1000 - 1);\n    } else {\n      this._cursor = this._date;\n    }\n    return chunk;\n  }\n}\n\nexport class PlayerDataLoader implements DataLoader<PlayerMetadata> {\n  _playerId: string;\n  _startDate: dayjs.Dayjs;\n  _endDate: dayjs.Dayjs;\n  _cursor: dayjs.Dayjs;\n  _mode: GameMode[];\n  _initialParams: string;\n  _tag: string;\n  constructor(playerId: string, startDate?: dayjs.Dayjs, endDate?: dayjs.Dayjs, mode = [] as GameMode[]) {\n    this._playerId = playerId;\n    this._startDate = startDate || dayjs(\"2010-01-01T00:00:00.000Z\");\n    this._endDate = endDate || dayjs().endOf(\"day\");\n    this._cursor = this._endDate;\n    this._mode = mode;\n    this._initialParams = this._getParams();\n    this._tag = \"\";\n  }\n  _getDatePath(): string {\n    let result = `/${this._startDate.valueOf()}`;\n    if (this._cursor) {\n      result += `/${this._cursor.valueOf()}`;\n    }\n    return result;\n  }\n  _getParams(mode = this._mode): string {\n    return `${this._playerId}${this._getDatePath()}?mode=${(mode.length ? mode : Conf.availableModes).join(\".\")}`;\n  }\n  getEstimatedChunkSize() {\n    return CHUNK_SIZE;\n  }\n  async getMetadata(): Promise<PlayerMetadata> {\n    if (this._endDate.isBefore(this._startDate)) {\n      return Promise.reject(new Error(\"Invalid date range\"));\n    }\n    const stats = await apiGet<PlayerMetadata>(`player_stats/${this._initialParams}`);\n    if (this._mode.length || !Conf.availableModes.length) {\n      stats.extended_stats = apiGet<PlayerExtendedStats>(`player_extended_stats/${this._initialParams}`).then(\n        (extendedStats) => (stats.extended_stats = extendedStats)\n      );\n    }\n    if (!this._mode.length && Conf.availableModes.length) {\n      stats.count = 0;\n    }\n    let crossStats = stats;\n    if (this._mode.length && !Conf.availableModes.every((x) => this._mode.includes(x))) {\n      crossStats = await apiGet<PlayerMetadata>(`player_stats/${this._getParams([])}`);\n    }\n    stats.cross_stats = {\n      id: crossStats.id,\n      level: crossStats.level,\n      max_level: crossStats.max_level,\n      played_modes:\n        crossStats.played_modes\n          ?.map((x) => (typeof x === \"string\" ? (parseInt(x, 10) as GameMode) : x))\n          ?.sort((a, b) => Conf.availableModes.indexOf(a) - Conf.availableModes.indexOf(b)) || [],\n      nickname: crossStats.nickname,\n      count: crossStats.count,\n    };\n    this._tag = stats.count.toString();\n    return stats;\n  }\n  async getNextChunk(): Promise<GameRecord[]> {\n    if (this._cursor.isBefore(this._startDate) || this._cursor.isSame(this._startDate)) {\n      return [];\n    }\n    if (!this._mode.length && Conf.availableModes.length) {\n      return [];\n    }\n    const chunk = await apiGet<GameRecord[]>(\n      `player_records/${this._playerId}/${this._cursor.valueOf()}/${this._startDate.valueOf()}?limit=${\n        CHUNK_SIZE + ((parseInt(this._tag, 10) || 0) % CHUNK_SIZE)\n      }&mode=${this._mode}&descending=true&tag=${this._tag}`\n    );\n    if (chunk.length) {\n      this._cursor = dayjs(chunk[chunk.length - 1].startTime * 1000 - 1);\n    } else {\n      this._cursor = this._startDate;\n    }\n    this._tag = \"\";\n    return chunk;\n  }\n}\n","import dayjs from \"dayjs\";\n\nimport { GameRecord } from \"../../types/record\";\nimport { Metadata, PlayerMetadata } from \"../../types/metadata\";\nimport { ListingDataLoader, PlayerDataLoader, DataLoader, RecentHighlightDataLoader } from \"./loader\";\nimport { GameMode } from \"../../types\";\n\nexport type FilterPredicate<TRecord = GameRecord> = ((record: TRecord) => boolean) | null;\nclass DataProviderImpl<TMetadata extends Metadata, TRecord extends { uuid: string } = GameRecord> {\n  _loader: DataLoader<TMetadata, TRecord>;\n  _metadata: TMetadata | Promise<TMetadata> | null;\n  _metadataError?: unknown;\n  _countPromise: Promise<number> | null;\n  _loadingPromise: Promise<unknown> | null;\n  _data: TRecord[];\n  _filterPredicate: FilterPredicate<TRecord>;\n  _filteredIndices: number[] | null;\n  _filterResultCache: { [uuid: string]: boolean };\n\n  constructor(loader: DataLoader<TMetadata, TRecord>) {\n    this._loader = loader;\n    this._metadata = null;\n    this._data = [];\n    this._countPromise = null;\n    this._filterPredicate = null;\n    this._filteredIndices = null;\n    this._filterResultCache = {};\n    this._loadingPromise = null;\n  }\n  setFilterPredicate(predicate: FilterPredicate<TRecord>) {\n    if (this._filterPredicate === predicate) {\n      return;\n    }\n    this._filterPredicate = predicate;\n    this._filterResultCache = {};\n    this.updateFilteredIndices();\n  }\n  updateFilteredIndices() {\n    this._filteredIndices = null;\n    if (!this._filterPredicate) {\n      return;\n    }\n    const metadata = this.getMetadataSync();\n    if (!metadata) {\n      return;\n    }\n    const count = this.getEstimatedCountSync();\n    const indices = [];\n    for (let i = 0; i < count; i++) {\n      if (i >= this._data.length) {\n        indices.push(i);\n        continue;\n      }\n      const game = this._data[i];\n      let result = this._filterResultCache[game.uuid];\n      if (result === undefined) {\n        this._filterResultCache[game.uuid] = result = this._filterPredicate(game);\n      }\n      if (result) {\n        indices.push(i);\n      }\n    }\n    this._filteredIndices = indices;\n  }\n  getMetadataSync(): TMetadata | null {\n    if (this._metadataError) {\n      throw this._metadataError;\n    }\n    return this._metadata && !(this._metadata instanceof Promise) ? this._metadata : null;\n  }\n  getEstimatedCountSync(): number {\n    const metadata = this.getMetadataSync();\n    const count = metadata ? metadata.count : this._data.length + 100;\n    if (count === +Infinity) {\n      return this._data.length + 100;\n    }\n    return count;\n  }\n  getCountMaybeSync(): number | Promise<number> {\n    const metadata = this.getMetadataSync();\n    if (metadata) {\n      return this._filteredIndices ? this._filteredIndices.length : this.getEstimatedCountSync();\n    }\n    return this.getCount().catch(() => 0); // Have to catch here to avoid unhandled promise rejection\n  }\n  async getCount(): Promise<number> {\n    const metadata = this.getMetadataSync();\n    if (metadata) {\n      return this.getCountMaybeSync();\n    }\n    if (!this._metadata) {\n      this._metadata = this._loader.getMetadata().then((metadata) => {\n        if (!metadata) {\n          console.log(\"No metadata returned\");\n          throw new Error(\"No metadata returned\");\n        }\n        this._metadata = metadata;\n        this.updateFilteredIndices();\n        this._countPromise = null;\n        return metadata;\n      });\n      this._metadata.catch((e) => {\n        console.error(e);\n        this._metadataError = e;\n      });\n    }\n    if (this._countPromise) {\n      return this._countPromise;\n    }\n    this._countPromise = Promise.resolve(this._metadata)\n      .then(() => new Promise((resolve) => setTimeout(resolve, 100)))\n      .then(() => this.getCountMaybeSync());\n    this._countPromise.catch(() => {\n      /* Kill unhandled rejection */\n    });\n    return this._countPromise;\n  }\n  getUnfilteredCountSync(): number | null {\n    const metadata = this.getMetadataSync();\n    if (!metadata) {\n      return null;\n    }\n    return this.getEstimatedCountSync();\n  }\n  isItemLoaded(index: number): boolean {\n    const mappedIndex = this._mapItemIndex(index);\n    if (mappedIndex === null) {\n      return false;\n    }\n    return mappedIndex < this._data.length;\n  }\n  getItem(index: number, skipPreload = false): TRecord | Promise<TRecord | null> {\n    const mappedIndex = this._mapItemIndex(index);\n    if (mappedIndex === null) {\n      return this.getCount()\n        .then((count) => {\n          const newMappedIndex = this._mapItemIndex(index);\n          if (index > count - 1 || newMappedIndex === null) {\n            return null;\n          }\n          return this.getItem(index, skipPreload);\n        })\n        .catch(() => null);\n    }\n    if (mappedIndex >= this._data.length) {\n      const curLength = this._data.length;\n      return this._loadNextChunk().then(() => {\n        if (this._data.length > curLength) {\n          return this.getItem(index, skipPreload);\n        }\n        return null;\n      });\n    }\n    if (!skipPreload && !this._filteredIndices) {\n      this.preload(index + this._loader.getEstimatedChunkSize() / 2);\n    }\n    return this._data[mappedIndex];\n  }\n  preload(index: number) {\n    const count = this.getCountMaybeSync();\n    if (count instanceof Promise) {\n      return;\n    }\n    if (index >= count) {\n      return;\n    }\n    this.getItem(index, true);\n  }\n  _mapItemIndex(requestedIndex: number): number | null {\n    const count = this.getCountMaybeSync();\n    if (count instanceof Promise) {\n      return null;\n    }\n    if (requestedIndex < 0 || requestedIndex >= count) {\n      return null;\n    }\n    return this._filteredIndices ? this._filteredIndices[requestedIndex] : requestedIndex;\n  }\n  async _loadNextChunk(): Promise<unknown> {\n    if (this._loadingPromise) {\n      return this._loadingPromise;\n    }\n    this._loadingPromise = (async () => {\n      const count = this.getUnfilteredCountSync() || 0;\n      if (this._data.length >= count) {\n        this._loadingPromise = null;\n        return;\n      }\n      const nextChunk = await this._loader.getNextChunk();\n      this._loadingPromise = null;\n      if (nextChunk.length) {\n        this._data.splice(this._data.length, 0, ...nextChunk);\n      } else {\n        const metadata = await this._metadata;\n        if (metadata) {\n          console.warn(\"Fixing incorrect item count: \" + metadata?.count + \" -> \" + this._data.length);\n          metadata.count = this._data.length;\n          this._metadata = metadata;\n        }\n      }\n      this.updateFilteredIndices();\n    })();\n    return this._loadingPromise;\n  }\n}\n\nexport type ListingDataProvider = DataProviderImpl<Metadata>;\nexport type PlayerDataProvider = DataProviderImpl<PlayerMetadata>;\n\nexport type DataProvider = ListingDataProvider | PlayerDataProvider;\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const DataProvider = Object.freeze({\n  createListing(date: dayjs.ConfigType, mode: GameMode | null): ListingDataProvider {\n    return new DataProviderImpl(new ListingDataLoader(date, mode));\n  },\n  createHightlight(mode: GameMode | undefined): ListingDataProvider {\n    return new DataProviderImpl(new RecentHighlightDataLoader(mode));\n  },\n  createPlayer(\n    playerId: string,\n    startDate: dayjs.ConfigType | null,\n    endDate: dayjs.ConfigType | null,\n    mode: GameMode[]\n  ): PlayerDataProvider {\n    return new DataProviderImpl(\n      new PlayerDataLoader(\n        playerId,\n        startDate ? dayjs(startDate).startOf(\"day\") : undefined,\n        endDate ? dayjs(endDate).endOf(\"day\") : undefined,\n        mode\n      )\n    );\n  },\n});\n","import React, { useMemo } from \"react\";\n\nimport { CheckboxGroup } from \"../form\";\nimport { GameMode, modeLabelNonTranslated } from \"../../data/types\";\nimport Conf from \"../../utils/conf\";\nimport { useTranslation } from \"react-i18next\";\n\nexport function ModeSelector({\n  mode,\n  onChange,\n  type = \"radio\",\n  availableModes = Conf.availableModes,\n  i18nNamespace = undefined,\n}: {\n  mode: GameMode[];\n  onChange: (x: GameMode[]) => void;\n  type?: \"checkbox\" | \"radio\";\n  availableModes?: GameMode[];\n  i18nNamespace?: string | undefined;\n}) {\n  useTranslation();\n  const items = useMemo(\n    () =>\n      availableModes.map((x) => ({\n        key: String(x),\n        label: modeLabelNonTranslated(x),\n        value: x,\n      })),\n    [availableModes]\n  );\n  if (items.length < 1) {\n    return null;\n  }\n  return (\n    <CheckboxGroup\n      type={type}\n      groupKey=\"ModeSelector\"\n      items={items}\n      selectedItems={mode.map((x) => x.toString())}\n      onChange={(newItems) => onChange(newItems.map((x) => x.value))}\n      i18nNamespace={i18nNamespace}\n    />\n  );\n}\n","/* eslint-disable @typescript-eslint/no-use-before-define */\n/* eslint-disable no-use-before-define */\nimport dayjs from \"dayjs\";\n\nimport { apiGet } from \"./api\";\nimport { PlayerMetadataLite, PlayerExtendedStats, GameMode } from \"../types\";\nimport { RankingTimeSpan, DeltaRankingResponse } from \"../types\";\nimport { RankRateBySeat } from \"../types\";\nimport { CareerRankingItem, CareerRankingType } from \"../types/ranking\";\nimport { GlobalStatistics, FanStats } from \"../types/statistics\";\n\nexport async function searchPlayer(prefix: string, limit = 20): Promise<PlayerMetadataLite[]> {\n  prefix = prefix.trim();\n  if (!prefix) {\n    return [];\n  }\n  return apiGet<PlayerMetadataLite[]>(`search_player/${encodeURIComponent(prefix)}?limit=${limit}`);\n}\n\nexport async function getExtendedStats(\n  playerId: number,\n  startDate?: dayjs.ConfigType,\n  endDate?: dayjs.ConfigType,\n  mode = \"\"\n): Promise<PlayerExtendedStats> {\n  let datePath = \"\";\n  if (startDate) {\n    datePath += `/${dayjs(startDate).valueOf()}`;\n    if (endDate) {\n      datePath += `/${dayjs(endDate).valueOf()}`;\n    }\n  }\n  return await apiGet<PlayerExtendedStats>(`player_extended_stats/${playerId}${datePath}?mode=${mode}`);\n}\n\nexport async function getDeltaRanking(timespan: RankingTimeSpan): Promise<DeltaRankingResponse> {\n  return await apiGet<DeltaRankingResponse>(`player_delta_ranking/${timespan}`);\n}\n\nexport async function getCareerRanking(type: CareerRankingType, modeId?: string): Promise<CareerRankingItem[]> {\n  return await apiGet<CareerRankingItem[]>(`career_ranking/${type}?mode=${modeId || \"\"}`);\n}\n\nexport async function getGlobalStatistics(modes: GameMode[]): Promise<GlobalStatistics> {\n  return await apiGet<GlobalStatistics>(`global_statistics_2?mode=${modes.join(\".\")}`);\n}\nexport async function getFanStats(): Promise<FanStats> {\n  return await apiGet<FanStats>(\"fan_stats\");\n}\n\nexport async function getRankRateBySeat(): Promise<RankRateBySeat> {\n  type RawResponse = [[number, number, number], number][];\n  let rawResp = await apiGet<RawResponse>(\"rank_rate_by_seat\");\n  if (rawResp.some((x) => x[0][0] === null)) {\n    // Contest\n    rawResp = rawResp.filter((x) => x[0][0] !== 0);\n  }\n  const counts: {\n    [modeId: string]: { [rank: number]: number };\n  } = {};\n  let maxRank = 0;\n  for (const [[modeId, rank], count] of rawResp) {\n    if (maxRank < rank) {\n      maxRank = rank;\n    }\n    const modeIdStr = (modeId || 0).toString();\n    counts[modeIdStr] = counts[modeIdStr] || [];\n    counts[modeIdStr][rank] = counts[modeIdStr][rank] || 0;\n    counts[modeIdStr][rank] += count;\n  }\n  const result: RankRateBySeat = {};\n  for (const [[modeId, rank, seatId], count] of rawResp) {\n    const modeIdStr = (modeId || 0).toString();\n    result[modeIdStr] = result[modeIdStr] || [];\n    result[modeIdStr].numGames = counts[modeIdStr][rank];\n    result[modeIdStr][rank] = result[modeIdStr][rank] || Array(maxRank).fill(0);\n    result[modeIdStr][rank][seatId] = count / counts[modeIdStr][rank];\n  }\n  return result;\n}\n","\nimport { LevelWithDelta, Level, getTranslatedLevelTags } from \"./level\";\nimport { GameMode } from \"./gameMode\";\nimport { FanStatEntry } from \"./statistics\";\nimport { sum } from \"../../utils\";\nimport i18n from \"../../i18n\";\n\nconst t = i18n.t.bind(i18n);\n\nconst RANK_DELTA_4 = [15, 5, -5, -15];\nconst RANK_DELTA_3 = [15, 0, -15];\nconst RANK_DELTA = {\n  [GameMode.金]: RANK_DELTA_4,\n  [GameMode.玉]: RANK_DELTA_4,\n  [GameMode.王座]: RANK_DELTA_4,\n  [GameMode.金东]: RANK_DELTA_4,\n  [GameMode.玉东]: RANK_DELTA_4,\n  [GameMode.王座东]: RANK_DELTA_4,\n  [GameMode.三金]: RANK_DELTA_3,\n  [GameMode.三玉]: RANK_DELTA_3,\n  [GameMode.三王座]: RANK_DELTA_3,\n  [GameMode.三金东]: RANK_DELTA_3,\n  [GameMode.三玉东]: RANK_DELTA_3,\n  [GameMode.三王座东]: RANK_DELTA_3,\n};\nconst MODE_DELTA = {\n  [GameMode.金]: [80, 40, 0, 0],\n  [GameMode.玉]: [110, 55, 0, 0],\n  [GameMode.王座]: [120, 60, 0, 0],\n  [GameMode.金东]: [40, 20, 0, 0],\n  [GameMode.玉东]: [55, 30, 0, 0],\n  [GameMode.王座东]: [60, 30, 0, 0],\n  [GameMode.三金]: [105, 0, 0],\n  [GameMode.三玉]: [160, 0, 0],\n  [GameMode.三王座]: [240, 0, 0],\n  [GameMode.三金东]: [55, 0, 0],\n  [GameMode.三玉东]: [75, 0, 0],\n  [GameMode.三王座东]: [120, 0, 0],\n};\nconst MODE_BASE_POINT = {\n  [GameMode.金]: 25000,\n  [GameMode.玉]: 25000,\n  [GameMode.王座]: 25000,\n  [GameMode.金东]: 25000,\n  [GameMode.玉东]: 25000,\n  [GameMode.王座东]: 25000,\n  [GameMode.三金]: 35000,\n  [GameMode.三玉]: 35000,\n  [GameMode.三王座]: 35000,\n  [GameMode.三金东]: 35000,\n  [GameMode.三玉东]: 35000,\n  [GameMode.三王座东]: 35000,\n};\n\nexport type RankRates = [number, number, number, number] | [number, number, number];\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const RankRates = Object.freeze({\n  getAvg(rates: RankRates): number {\n    return sum(rates.map((value, index) => value * (index + 1))) / sum(rates);\n  },\n  normalize(rates: RankRates): RankRates {\n    const total = sum(rates);\n    return rates.map((value) => value / total) as RankRates;\n  },\n});\n\nexport type FanStatEntry2 = FanStatEntry & {\n  役满: number;\n};\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const FanStatEntry2 = Object.freeze({\n  formatFan(entry: FanStatEntry2): string {\n    if (entry.役满) {\n      if (entry.役满 === 1) {\n        return t(\"役满\");\n      }\n      return `${entry.役满} ${t(\"倍役满\")}`;\n    }\n    return `${entry.count} ${t(\"番\")}`;\n  },\n});\nexport type FanStatEntryList = FanStatEntry2[];\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const FanStatEntryList = Object.freeze({\n  formatFanSummary(list: FanStatEntryList): string {\n    const count = sum(list.map((x) => x.count));\n    const 役满 = sum(list.map((x) => x.役满));\n    if (役满) {\n      if (役满 === 1) {\n        return t(\"役满\");\n      }\n      return `${役满} ${t(\"倍役满\")}`;\n    }\n    let result = `${count} ${t(\"番\")}`;\n    if (count >= 13) {\n      result += \" - \" + t(\"累计役满\");\n    } else if (count >= 11) {\n      result += \" - \" + t(\"三倍满\");\n    } else if (count >= 8) {\n      result += \" - \" + t(\"倍满\");\n    } else if (count >= 6) {\n      result += \" - \" + t(\"跳满\");\n    } else if (count === 5) {\n      result += \" - \" + t(\"满贯\");\n    }\n    return result;\n  },\n});\n\nexport interface PlayerExtendedStats {\n  count: number;\n  和牌率: number;\n  自摸率: number;\n  默听率: number;\n  放铳率: number;\n  副露率: number;\n  立直率: number;\n  平均打点: number;\n  最大连庄?: number;\n  和了巡数: number;\n  平均铳点: number;\n  流局率: number;\n  流听率: number;\n  里宝率: number;\n  一发率: number;\n  被炸率: number;\n  平均被炸点数: number;\n  放铳时立直率: number;\n  放铳时副露率: number;\n  立直后放铳率: number;\n  立直后非瞬间放铳率: number;\n  副露后放铳率: number;\n  立直后和牌率: number;\n  副露后和牌率: number;\n  立直后流局率: number;\n  副露后流局率: number;\n  役满?: number;\n  累计役满?: number;\n  最大累计番数?: number;\n  W立直?: number;\n  流满?: number;\n  平均起手向听: number;\n  放铳至立直: number;\n  放铳至副露: number;\n  放铳至默听: number;\n  立直和了: number;\n  副露和了: number;\n  默听和了: number;\n  立直巡目: number;\n  立直流局: number;\n  立直收支: number;\n  立直收入: number;\n  立直支出: number;\n  先制率: number;\n  追立率: number;\n  被追率: number;\n  振听立直率: number;\n  最近大铳?: {\n    id: string;\n    start_time: number;\n    fans: FanStatEntryList;\n  };\n}\nexport interface Metadata {\n  count: number;\n}\nexport interface PlayerMetadataLite extends Metadata {\n  id: number;\n  nickname: string;\n  level: LevelWithDelta;\n}\nexport interface PlayerMetadataLite2 extends Metadata {\n  rank_rates: RankRates;\n  avg_rank: number;\n  negative_rate: number;\n}\nexport interface PlayerMetadata extends PlayerMetadataLite, PlayerMetadataLite2 {\n  rank_avg_score: RankRates;\n  max_level: LevelWithDelta;\n  played_modes?: (string | GameMode)[];\n  cross_stats?: PlayerMetadataLite & {\n    max_level: LevelWithDelta;\n    played_modes: GameMode[];\n  };\n  extended_stats?: PlayerExtendedStats | Promise<PlayerExtendedStats>;\n}\n\nexport function calculateDeltaPoint(\n  score: number,\n  rank: number,\n  mode: GameMode,\n  level: Level,\n  includePenalty = true,\n  trimNumber = true\n): number {\n  let result =\n    (trimNumber ? Math.ceil : (x: number) => x)((score - MODE_BASE_POINT[mode]) / 1000 + RANK_DELTA[mode][rank]) +\n    MODE_DELTA[mode][rank];\n  if (rank === RANK_DELTA[mode].length - 1 && includePenalty) {\n    result -= level.getPenaltyPoint(mode);\n  }\n  /*\n  console.log(\n    `calculateDeltaPoint: score=${score}, rank=${rank}, mode=${mode}, level=${level.getTag()}, result=${result}`\n  );\n  */\n  return result;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const PlayerMetadata = Object.freeze({\n  calculateRankDeltaPoints(\n    metadata: PlayerMetadata,\n    mode: GameMode,\n    level?: Level,\n    includePenalty = true,\n    trimNumber = true\n  ): RankRates {\n    const rankDeltaPoints = metadata.rank_avg_score.map((score, rank) =>\n      calculateDeltaPoint(\n        score,\n        rank,\n        mode,\n        level || LevelWithDelta.getAdjustedLevel(metadata.level),\n        includePenalty,\n        trimNumber\n      )\n    ) as typeof metadata.rank_avg_score;\n    return rankDeltaPoints;\n  },\n  calculateExpectedGamePoint(metadata: PlayerMetadata, mode: GameMode, level?: Level, includePenalty = true): number {\n    const rankDeltaPoints = PlayerMetadata.calculateRankDeltaPoints(metadata, mode, level, includePenalty);\n    const rankWeightedPoints = rankDeltaPoints.map((point, rank) => point * metadata.rank_rates[rank]);\n    const expectedGamePoint = rankWeightedPoints.reduce((a, b) => a + b, 0);\n    /*\n    console.log(rankDeltaPoints);\n    console.log(rankWeightedPoints);\n    console.log(\n      `calculateExpectedGamePoint: mode=${mode}, level=${level ? level.getTag() : \"\"}, result=${expectedGamePoint}`\n    );\n    */\n    return expectedGamePoint;\n  },\n  estimateStableLevel(metadata: PlayerMetadata, mode: GameMode): string {\n    const calcPoint = (level: Level) => PlayerMetadata.calculateExpectedGamePoint(metadata, mode, level);\n    let level = new Level(metadata.level.id);\n    let lastPositiveLevel: Level | undefined = undefined;\n    for (;;) {\n      const expectedGamePoint = calcPoint(level);\n      if (Math.abs(expectedGamePoint) < 0.001) {\n        return level.getTag() + \" (0)\";\n      }\n      if (expectedGamePoint >= 0) {\n        lastPositiveLevel = level;\n        level = level.getNextLevel();\n        if (!level.isAllowedMode(mode) || level === lastPositiveLevel) {\n          return `${lastPositiveLevel.getTag()}+ (${expectedGamePoint.toFixed(2)})`;\n        }\n      } else {\n        if (lastPositiveLevel) {\n          return `${lastPositiveLevel.getTag()} (${calcPoint(lastPositiveLevel).toFixed(2)})`;\n        }\n        break;\n      }\n    }\n    for (;;) {\n      const prevLevel = level.getPreviousLevel();\n      if (!prevLevel.isAllowedMode(mode) || prevLevel === level) {\n        return `${level.getTag()}- (${calcPoint(level).toFixed(2)})`;\n      }\n      level = prevLevel;\n      const expectedGamePoint = calcPoint(level);\n      if (expectedGamePoint > -0.001) {\n        return `${level.getTag()} (${Math.abs(calcPoint(level)).toFixed(2)})`;\n      }\n    }\n  },\n  formatStableLevel2(level: number): string {\n    const formatNumber = function (x: number): string {\n      // Trim after the second digit after decimal point\n      let s = x.toString();\n      if (s.indexOf(\".\") === -1) {\n        s += \".00\";\n      }\n      if (s.length < 8) {\n        s += \"00\";\n      }\n      return s.slice(0, s.indexOf(\".\") + 3);\n    };\n    const translatedLevelTags = getTranslatedLevelTags();\n    if (level >= 7) {\n      return `${translatedLevelTags[5]}${formatNumber(level - 6)}`;\n    }\n    if (level >= 4) {\n      return `${translatedLevelTags[4]}${formatNumber(level - 3)}`;\n    }\n    return `${translatedLevelTags[3]}${formatNumber(level)}`;\n  },\n  getStableLevelComponents(metadata: PlayerMetadata, mode: GameMode): RankRates {\n    return this.calculateRankDeltaPoints(metadata, mode, undefined, false, false);\n  },\n  estimateStableLevel2(metadata: PlayerMetadata, mode: GameMode): string {\n    if (![GameMode.玉, GameMode.王座].includes(mode)) {\n      return this.estimateStableLevel(metadata, mode);\n    }\n    if (!metadata.rank_rates[3]) {\n      return \"\";\n    }\n    const estimatedPoints = this.calculateExpectedGamePoint(metadata, mode, undefined, false);\n    const result = estimatedPoints / (metadata.rank_rates[3] * 15) - 10;\n    return PlayerMetadata.formatStableLevel2(result);\n  },\n});\n","import { LevelWithDelta } from \"./level\";\nimport { PlayerMetadata } from \"./metadata\";\n\nexport enum RankingTimeSpan {\n  OneWeek = \"1w\",\n  FourWeeks = \"4w\"\n}\nexport type DeltaRankingItem = {\n  id: number;\n  nickname: string;\n  level: LevelWithDelta;\n  delta: number;\n};\nexport type DeltaRankingResponse = {\n  [modeId: string]: {\n    top: DeltaRankingItem[];\n    bottom: DeltaRankingItem[];\n  };\n};\nexport interface CareerRankingItem extends PlayerMetadata {\n  rank_key: number;\n  count: number;\n}\nexport enum CareerRankingType {\n  Rank1 = \"rank1\",\n  Rank12 = \"rank12\",\n  Rank123 = \"rank123\",\n  Rank3 = \"rank3\",\n  Rank4 = \"rank4\",\n  AvgRank = \"avg_rank\",\n  MaxLevelGlobal = \"max_level_global\",\n  NumGames = \"num_games\",\n  StableLevel = \"stable_level\",\n  PointEfficiency = \"point_efficiency\",\n  Win = \"win\",\n  Lose = \"lose\",\n  WinLoseDiff = \"win_lose_diff\",\n  WinRev = \"win_rev\",\n  LoseRev = \"lose_rev\",\n  ExpectedGamePoint0 = \"expected_game_point_0\",\n  ExpectedGamePoint1 = \"expected_game_point_1\",\n  ExpectedGamePoint2 = \"expected_game_point_2\",\n  ExpectedGamePoint3 = \"expected_game_point_3\",\n  里宝率 = \"里宝率\",\n  被炸率 = \"被炸率\",\n  一发率 = \"一发率\",\n  里宝率Rev = \"里宝率_rev\",\n  被炸率Rev = \"被炸率_rev\",\n  一发率Rev = \"一发率_rev\",\n}\n","import { GameMode } from \"../data/types\";\nimport dayjs from \"dayjs\";\n\nconst domain =\n  sessionStorage.getItem(\"overrideDomain\") || localStorage.getItem(\"overrideDomain\") || window.location.hostname;\n\nexport const CONFIGURATIONS = {\n  DEFAULT: {\n    apiSuffix: process.env.NODE_ENV === \"development\" ? \"api-test/v2/pl4/\" : \"api/v2/pl4/\",\n    features: {\n      ranking: [GameMode.王座, GameMode.玉] as GameMode[] | false,\n      rankingGroups: [[GameMode.王座, GameMode.玉]] as GameMode[][] | null,\n      statistics: true,\n      estimatedStableLevel: true,\n      contestTools: false,\n      statisticsSubPages: {\n        rankBySeat: true,\n        dataByRank: [GameMode.王座, GameMode.玉, GameMode.王座东, GameMode.玉东] as GameMode[] | false,\n        fanStats: true,\n      },\n    },\n    table: {\n      showGameMode: true,\n    },\n    availableModes: [GameMode.王座, GameMode.玉, GameMode.金, GameMode.王座东, GameMode.玉东, GameMode.金东],\n    modePreference: [GameMode.王座, GameMode.玉, GameMode.王座东, GameMode.玉东, GameMode.金, GameMode.金东],\n    dateMin: dayjs(\"2019-08-23\", \"YYYY-MM-DD\"),\n    siteTitle: \"雀魂牌谱屋\",\n    canonicalDomain: \"amae-koromo.sapk.ch\",\n    showTopNotice: true,\n    mirrorUrl: \"https://saki.sapk.ch/\",\n    rootClassName: \"koromo\",\n    rankColors: [\"#28a745\", \"#17a2b8\", \"#6c757d\", \"#dc3545\"],\n  },\n  ikeda: {\n    apiSuffix: \"api/v2/pl3/\",\n    features: {\n      ranking: [GameMode.三王座, GameMode.三玉, GameMode.三金, GameMode.三王座东, GameMode.三玉东, GameMode.三金东],\n      rankingGroups: [\n        [GameMode.三王座, GameMode.三玉, GameMode.三金],\n        [GameMode.三王座东, GameMode.三玉东, GameMode.三金东],\n      ],\n      statistics: true,\n      estimatedStableLevel: true,\n      contestTools: false,\n      statisticsSubPages: {\n        rankBySeat: true,\n        dataByRank: [\n          GameMode.三王座,\n          GameMode.三玉,\n          GameMode.三金,\n          GameMode.三王座东,\n          GameMode.三玉东,\n          GameMode.三金东,\n        ],\n        fanStats: true,\n      },\n    },\n    availableModes: [\n      GameMode.三王座,\n      GameMode.三玉,\n      GameMode.三金,\n      GameMode.三王座东,\n      GameMode.三玉东,\n      GameMode.三金东,\n    ],\n    modePreference: [\n      GameMode.三王座,\n      GameMode.三玉,\n      GameMode.三王座东,\n      GameMode.三玉东,\n      GameMode.三金,\n      GameMode.三金东,\n    ],\n    dateMin: dayjs(\"2019-11-29\", \"YYYY-MM-DD\"),\n    siteTitle: \"雀魂牌谱屋·三麻\",\n    canonicalDomain: \"ikeda.sapk.ch\",\n    mirrorUrl: \"https://momoko.sapk.ch/\",\n    rankColors: [\"#28a745\", \"#6c757d\", \"#dc3545\"],\n    rootClassName: \"yuuki\",\n  },\n  contest: {\n    apiSuffix: (s: string) => `api/contest/${s}/`,\n    features: {\n      ranking: false as const,\n      rankingGroups: null,\n      statistics: true,\n      estimatedStableLevel: false,\n      contestTools: true,\n      statisticsSubPages: {\n        rankBySeat: true,\n        dataByRank: false as const,\n        fanStats: true,\n      },\n    },\n    table: {\n      showGameMode: true,\n    },\n    availableModes: [],\n    canonicalDomain: domain,\n    showTopNotice: false,\n  },\n};\n\ntype Configuration = typeof CONFIGURATIONS.DEFAULT;\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction mergeDeep<T extends { [key: string]: any }>(...objects: Partial<T>[]): T {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const isObject = <T>(obj: T) => obj && typeof obj === \"object\" && (obj as any).constructor === Object;\n\n  return objects.reduce((prev: T, obj: Partial<T>) => {\n    Object.keys(obj).forEach((key: keyof T) => {\n      const pVal = prev[key];\n      const oVal = obj[key];\n\n      if (Array.isArray(pVal) && Array.isArray(oVal)) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        prev[key] = oVal as any;\n      } else if (isObject(pVal) && isObject(oVal)) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        prev[key] = mergeDeep(pVal, oVal as any);\n      } else {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        prev[key] = oVal as any;\n      }\n    });\n\n    return prev;\n  }, {} as T) as T;\n}\n\nconst ConfBase: Partial<Configuration> = (() => {\n  if (/^(ikeda|momoko)\\./i.test(domain)) {\n    return CONFIGURATIONS.ikeda;\n  }\n  const m = /^([^.]+)\\.contest\\./i.exec(domain);\n  if (m) {\n    return { ...CONFIGURATIONS.contest, apiSuffix: CONFIGURATIONS.contest.apiSuffix(m[1]) };\n  }\n  return CONFIGURATIONS.DEFAULT;\n})();\n\nconst Conf = mergeDeep<Configuration>(CONFIGURATIONS.DEFAULT, ConfBase);\n\ndocument.documentElement.className += \" \" + Conf.rootClassName;\n\nexport default Conf;\n","import React, { ReactNode } from \"react\";\r\nimport { Trans } from \"react-i18next\";\r\n\r\nexport const FormRow = ({ title = \"\", inline = false, children = undefined as ReactNode }) => (\r\n  <>\r\n    <label className={\"col-form-label\"}>\r\n      <Trans ns=\"formRow\">{title}</Trans>\r\n    </label>\r\n    <div className={`col-form-control ${inline ? \"form-inline\" : \"\"}`}>{children}</div>\r\n  </>\r\n);\r\n","import dayjs from \"dayjs\";\n\nimport { GameMode } from \"./gameMode\";\nimport { getRankLabelByIndex } from \"./utils\";\nimport Conf from \"../../utils/conf\";\n\nimport i18n from \"../../i18n\";\nimport { FanStatEntryList } from \"./metadata\";\n\nexport interface PlayerRecord {\n  accountId: number;\n  nickname: string;\n  level: number;\n  score: number;\n}\nexport interface GameRecord {\n  _id?: string;\n  modeId: GameMode;\n  uuid: string;\n  startTime: number;\n  endTime: number;\n  players: PlayerRecord[];\n}\nexport type HighlightEvent = {\n  type: \"役满\";\n  fan: FanStatEntryList;\n  player: number;\n};\nexport type GameRecordWithEvent = GameRecord & {\n  event: HighlightEvent;\n};\n// eslint-disable-next-line @typescript-eslint/no-redeclare\nexport const GameRecord = Object.freeze({\n  getRankIndexByPlayer(rec: GameRecord, player: number | string | PlayerRecord): number {\n    const playerId = (typeof player === \"object\" ? player.accountId : player).toString();\n    const sortedPlayers = rec.players.map((player, index) => ({ player, index }));\n    sortedPlayers.sort((a, b) => 5 - b.index + b.player.score - (5 - a.index + a.player.score));\n    for (let i = 0; i < sortedPlayers.length; i++) {\n      if (sortedPlayers[i].player.accountId.toString() === playerId) {\n        return i;\n      }\n    }\n    return -1;\n  },\n  getPlayerRankLabel(rec: GameRecord, player: number | string | PlayerRecord): string {\n    return getRankLabelByIndex(GameRecord.getRankIndexByPlayer(rec, player)) || \"\";\n  },\n  getPlayerRankColor(rec: GameRecord, player: number | string | PlayerRecord): string {\n    return Conf.rankColors[GameRecord.getRankIndexByPlayer(rec, player)];\n  },\n  encodeAccountId: (t: number) => 1358437 + ((7 * t + 1117113) ^ 86216345),\n  getStartTime: (rec: GameRecord | number) => (typeof rec === \"number\" ? rec : rec.startTime) * 1000,\n  formatFullStartTime: (rec: GameRecord | number) => dayjs(GameRecord.getStartTime(rec)).format(\"YYYY/M/D HH:mm\"),\n  formatStartDate: (rec: GameRecord | number) => dayjs(GameRecord.getStartTime(rec)).format(\"M/D\"),\n  getRecordLink(rec: GameRecord | string, player?: PlayerRecord | number | string) {\n    const playerId = typeof player === \"object\" ? player.accountId : player;\n    const trailer = playerId\n      ? `_a${GameRecord.encodeAccountId(typeof playerId === \"number\" ? playerId : parseInt(playerId))}`\n      : \"\";\n    const uuid = typeof rec === \"string\" ? rec : rec.uuid;\n    return `${i18n.t(\"https://game.maj-soul.com/1/\")}?paipu=${uuid}${trailer}`;\n  },\n});\n","export enum AccountZone {\n  China = 1,\n  Japan = 2,\n  International = 3,\n  Unknown = -1,\n}\n\nexport function getAccountZone(accountId: number): AccountZone {\n  if (!accountId) {\n    return AccountZone.Unknown;\n  }\n  const prefix = accountId >> 23;\n  if (prefix >= 0 && prefix <= 6) {\n    return AccountZone.China;\n  }\n  if (prefix >= 7 && prefix <= 12) {\n    return AccountZone.Japan;\n  }\n  if (prefix >= 13 && prefix <= 15) {\n    return AccountZone.International;\n  }\n  return AccountZone.Unknown;\n}\n\nexport function getAccountZoneTag(accountId: number): string {\n  switch (getAccountZone(accountId)) {\n    case AccountZone.China:\n      return \"Ⓒ\";\n    case AccountZone.Japan:\n      return \"Ⓙ\";\n    case AccountZone.International:\n      return \"Ⓔ\";\n    default:\n      return \"\";\n  }\n}\n","import React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { IoMdBook } from \"react-icons/io\";\n\nimport { GameRecord, PlayerRecord, getLevelTag } from \"../../data/types\";\nimport { generatePlayerPathById } from \"./routes\";\n\nexport const Player = function({\n  player,\n  game,\n  isActive\n}: {\n  player: PlayerRecord;\n  game: GameRecord;\n  isActive: boolean;\n}) {\n  const { nickname, level, score, accountId } = player;\n  const isTop = GameRecord.getRankIndexByPlayer(game, player) === 0;\n  return (\n    <span className={`player ${isTop && \"font-weight-bold\"} ${isActive && \"active-player\"}`}>\n      <a href={GameRecord.getRecordLink(game, player)} title=\"查看牌谱\" target=\"_blank\" rel=\"noopener noreferrer\">\n        [{getLevelTag(level)}] {nickname} {score !== undefined && `[${score}]`}\n      </a>{\" \"}\n      <Link className=\"detail-link\" title=\"玩家记录\" to={generatePlayerPathById(accountId)}>\n        <IoMdBook />\n      </Link>\n    </span>\n  );\n};\n"],"sourceRoot":""}